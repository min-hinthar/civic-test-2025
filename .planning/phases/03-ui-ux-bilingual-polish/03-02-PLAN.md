---
phase: 03-ui-ux-bilingual-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/Button.tsx
  - src/components/ui/Card.tsx
  - src/components/ui/Skeleton.tsx
  - src/hooks/useReducedMotion.ts
autonomous: true

must_haves:
  truths:
    - "Buttons have pill shape and spring animation on press"
    - "Cards have elevated shadow and hover lift effect"
    - "Skeleton components show shimmer animation"
    - "Animations respect prefers-reduced-motion"
  artifacts:
    - path: "src/components/ui/Button.tsx"
      provides: "Animated pill button with scale-down on press"
      exports: ["Button"]
    - path: "src/components/ui/Card.tsx"
      provides: "Elevated card with hover shadow lift"
      exports: ["Card", "CardHeader", "CardContent"]
    - path: "src/components/ui/Skeleton.tsx"
      provides: "Shimmer skeleton loader component"
      exports: ["Skeleton"]
    - path: "src/hooks/useReducedMotion.ts"
      provides: "Hook to detect prefers-reduced-motion"
      exports: ["useReducedMotion"]
  key_links:
    - from: "src/components/ui/Button.tsx"
      to: "motion/react"
      via: "motion.button wrapper"
      pattern: "motion\\.button"
    - from: "src/components/ui/Card.tsx"
      to: "motion/react"
      via: "motion.div wrapper"
      pattern: "motion\\.div"
---

<objective>
Create core animated UI components: Button with pill shape and tactile press feedback, Card with elevation and hover effects, and Skeleton loader with shimmer.

Purpose: These base components are used throughout the app. Adding Motion animations here provides consistent tactile feedback (Duolingo-style) without modifying every page.

Output: Reusable Button, Card, and Skeleton components with Motion animations and reduced-motion support.
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-ui-ux-bilingual-polish/03-CONTEXT.md
@.planning/phases/03-ui-ux-bilingual-polish/03-RESEARCH.md
@src/lib/design-tokens.ts
@src/styles/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useReducedMotion hook</name>
  <files>
    src/hooks/useReducedMotion.ts
  </files>
  <action>
Create `src/hooks/useReducedMotion.ts`:

```typescript
'use client';

import { useReducedMotion as useMotionReducedMotion } from 'motion/react';

/**
 * Hook to detect user's prefers-reduced-motion preference.
 * Uses Motion's built-in hook for consistency with animation library.
 *
 * @returns true if user prefers reduced motion, false otherwise
 *
 * Usage:
 * ```tsx
 * const shouldReduceMotion = useReducedMotion();
 * const animation = shouldReduceMotion ? {} : { scale: 1.05 };
 * ```
 */
export function useReducedMotion(): boolean {
  const prefersReduced = useMotionReducedMotion();
  // Motion's hook returns null during SSR, treat as no preference
  return prefersReduced ?? false;
}
```

This wraps Motion's hook to handle the SSR null case gracefully.
  </action>
  <verify>
Import hook in a test component, verify it returns boolean.
Check that Motion package is installed (`pnpm list motion`).
  </verify>
  <done>
useReducedMotion hook created, handles SSR gracefully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create animated Button component</name>
  <files>
    src/components/ui/Button.tsx
  </files>
  <action>
Create `src/components/ui/Button.tsx` with Motion animations:

```typescript
'use client';

import { forwardRef, ButtonHTMLAttributes, ReactNode } from 'react';
import { motion, MotionProps } from 'motion/react';
import { useReducedMotion } from '@/hooks/useReducedMotion';
import { clsx } from 'clsx';

// Spring physics for Duolingo-style tactile feedback
const springTransition = {
  type: 'spring' as const,
  stiffness: 400,
  damping: 17,
};

// Button variants
const variants = {
  primary:
    'bg-primary-500 text-white hover:bg-primary-600 active:bg-primary-700 shadow-lg shadow-primary-500/25',
  secondary:
    'bg-primary-100 text-primary-700 hover:bg-primary-200 active:bg-primary-300 dark:bg-primary-900 dark:text-primary-100',
  outline:
    'border-2 border-primary-500 text-primary-600 hover:bg-primary-50 active:bg-primary-100 dark:text-primary-400 dark:hover:bg-primary-900/50',
  ghost:
    'text-primary-600 hover:bg-primary-100 active:bg-primary-200 dark:text-primary-400 dark:hover:bg-primary-900/50',
  destructive:
    'bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-lg shadow-destructive/25',
  success:
    'bg-success-500 text-white hover:bg-success-600 shadow-lg shadow-success-500/25',
};

// Button sizes
const sizes = {
  sm: 'px-3 py-1.5 text-sm min-h-[36px]',
  md: 'px-5 py-2.5 text-base min-h-[44px]', // 44px minimum for touch targets
  lg: 'px-8 py-3.5 text-lg min-h-[52px]',
};

export interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: keyof typeof variants;
  size?: keyof typeof sizes;
  fullWidth?: boolean;
  loading?: boolean;
  children: ReactNode;
}

/**
 * Animated pill button with Duolingo-style tactile feedback.
 *
 * Features:
 * - Scale down + spring back on press
 * - Scale up + shadow lift on hover (desktop)
 * - Pill shape (fully rounded ends)
 * - Respects prefers-reduced-motion
 * - 44px minimum height for touch accessibility
 */
export const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  (
    {
      variant = 'primary',
      size = 'md',
      fullWidth = false,
      loading = false,
      disabled = false,
      className,
      children,
      ...props
    },
    ref
  ) => {
    const shouldReduceMotion = useReducedMotion();

    // Animation variants
    const motionVariants = {
      idle: { scale: 1 },
      hover: shouldReduceMotion
        ? {}
        : {
            scale: 1.03,
            boxShadow: '0 8px 30px rgba(0,0,0,0.12)',
          },
      tap: shouldReduceMotion ? {} : { scale: 0.97 },
    };

    const isDisabled = disabled || loading;

    return (
      <motion.button
        ref={ref}
        variants={motionVariants}
        initial="idle"
        whileHover={isDisabled ? undefined : 'hover'}
        whileTap={isDisabled ? undefined : 'tap'}
        transition={springTransition}
        disabled={isDisabled}
        className={clsx(
          // Base styles
          'inline-flex items-center justify-center font-semibold',
          // Pill shape (fully rounded)
          'rounded-full',
          // Focus ring
          'focus-visible:outline-none focus-visible:ring-3 focus-visible:ring-primary-500 focus-visible:ring-offset-2',
          // Disabled state
          'disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none',
          // Transition for non-motion properties
          'transition-colors duration-150',
          // Variant and size
          variants[variant],
          sizes[size],
          // Full width
          fullWidth && 'w-full',
          className
        )}
        {...props}
      >
        {loading ? (
          <span className="flex items-center gap-2">
            <svg
              className="h-4 w-4 animate-spin"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                className="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                strokeWidth="4"
              />
              <path
                className="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              />
            </svg>
            {children}
          </span>
        ) : (
          children
        )}
      </motion.button>
    );
  }
);

Button.displayName = 'Button';
```
  </action>
  <verify>
Import Button in a page, render it.
Click should show scale-down spring animation.
Hover should show scale-up with shadow.
Disabled button should not animate.
  </verify>
  <done>
Animated Button component with pill shape, spring press animation, hover lift, and reduced-motion support.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create animated Card and Skeleton components</name>
  <files>
    src/components/ui/Card.tsx
    src/components/ui/Skeleton.tsx
  </files>
  <action>
Create `src/components/ui/Card.tsx`:

```typescript
'use client';

import { forwardRef, HTMLAttributes, ReactNode } from 'react';
import { motion } from 'motion/react';
import { useReducedMotion } from '@/hooks/useReducedMotion';
import { clsx } from 'clsx';

// Spring physics for hover effect
const springTransition = {
  type: 'spring' as const,
  stiffness: 300,
  damping: 20,
};

export interface CardProps extends HTMLAttributes<HTMLDivElement> {
  elevated?: boolean;
  interactive?: boolean;
  children: ReactNode;
}

/**
 * Elevated card with subtle shadow and hover lift effect.
 *
 * Features:
 * - Paper-like physical card aesthetic
 * - Subtle elevation with light shadows
 * - Hover lift + shadow increase (when interactive)
 * - 16px+ border radius (bubbly, friendly)
 * - Respects prefers-reduced-motion
 */
export const Card = forwardRef<HTMLDivElement, CardProps>(
  ({ elevated = true, interactive = false, className, children, ...props }, ref) => {
    const shouldReduceMotion = useReducedMotion();

    const baseClasses = clsx(
      // Base card styles
      'bg-card text-card-foreground',
      // Rounded corners (16px+)
      'rounded-2xl',
      // Border
      'border border-border/60',
      // Padding
      'p-5',
      // Transition for non-motion properties
      'transition-colors duration-150',
      // Elevation shadow
      elevated && 'shadow-lg shadow-primary-500/10',
      className
    );

    // Non-interactive card - no motion
    if (!interactive) {
      return (
        <div ref={ref} className={baseClasses} {...props}>
          {children}
        </div>
      );
    }

    // Interactive card with hover animation
    const motionVariants = {
      idle: {
        y: 0,
        boxShadow: '0 10px 40px -10px rgba(59, 130, 246, 0.1)',
      },
      hover: shouldReduceMotion
        ? {}
        : {
            y: -4,
            boxShadow: '0 20px 60px -15px rgba(59, 130, 246, 0.25)',
          },
    };

    return (
      <motion.div
        ref={ref}
        variants={motionVariants}
        initial="idle"
        whileHover="hover"
        transition={springTransition}
        className={clsx(baseClasses, 'cursor-pointer')}
        {...props}
      >
        {children}
      </motion.div>
    );
  }
);

Card.displayName = 'Card';

/**
 * Card header section
 */
export function CardHeader({
  className,
  children,
  ...props
}: HTMLAttributes<HTMLDivElement>) {
  return (
    <div className={clsx('mb-4', className)} {...props}>
      {children}
    </div>
  );
}

/**
 * Card content section
 */
export function CardContent({
  className,
  children,
  ...props
}: HTMLAttributes<HTMLDivElement>) {
  return (
    <div className={clsx('', className)} {...props}>
      {children}
    </div>
  );
}

/**
 * Card footer section
 */
export function CardFooter({
  className,
  children,
  ...props
}: HTMLAttributes<HTMLDivElement>) {
  return (
    <div className={clsx('mt-4 pt-4 border-t border-border/40', className)} {...props}>
      {children}
    </div>
  );
}
```

Create `src/components/ui/Skeleton.tsx`:

```typescript
'use client';

import { HTMLAttributes } from 'react';
import { clsx } from 'clsx';

export interface SkeletonProps extends HTMLAttributes<HTMLDivElement> {
  /** Width of skeleton (default: 100%) */
  width?: string | number;
  /** Height of skeleton (default: 1rem) */
  height?: string | number;
  /** Make skeleton circular */
  circle?: boolean;
  /** Number of lines to render */
  lines?: number;
}

/**
 * Shimmer skeleton loader for async content.
 *
 * Features:
 * - Shimmer animation (feels alive)
 * - Respects prefers-reduced-motion (shows solid color)
 * - Supports multiple lines with staggered widths
 * - Circle variant for avatars
 */
export function Skeleton({
  width,
  height = '1rem',
  circle = false,
  lines = 1,
  className,
  style,
  ...props
}: SkeletonProps) {
  // Multiple lines with decreasing width
  if (lines > 1) {
    const lineWidths = ['100%', '85%', '70%', '90%', '60%'];
    return (
      <div className={clsx('space-y-2', className)} {...props}>
        {Array.from({ length: lines }).map((_, i) => (
          <div
            key={i}
            className="skeleton-shimmer rounded-lg"
            style={{
              width: lineWidths[i % lineWidths.length],
              height,
              ...style,
            }}
          />
        ))}
      </div>
    );
  }

  return (
    <div
      className={clsx(
        'skeleton-shimmer',
        circle ? 'rounded-full' : 'rounded-lg',
        className
      )}
      style={{
        width: width ?? '100%',
        height: circle ? width : height,
        ...style,
      }}
      {...props}
    />
  );
}

/**
 * Skeleton card matching Card component dimensions
 */
export function SkeletonCard({ className, ...props }: HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={clsx(
        'rounded-2xl border border-border/60 bg-card p-5',
        className
      )}
      {...props}
    >
      <Skeleton height="1.5rem" width="60%" className="mb-4" />
      <Skeleton lines={3} height="1rem" />
      <div className="mt-4 flex gap-2">
        <Skeleton height="2.5rem" width="6rem" className="rounded-full" />
        <Skeleton height="2.5rem" width="6rem" className="rounded-full" />
      </div>
    </div>
  );
}

/**
 * Skeleton for avatar/profile images
 */
export function SkeletonAvatar({
  size = 40,
  className,
}: {
  size?: number;
  className?: string;
}) {
  return <Skeleton circle width={size} height={size} className={className} />;
}
```
  </action>
  <verify>
Render Card with interactive prop, verify hover lift animation.
Render Skeleton with lines=3, verify shimmer animation.
Test SkeletonCard renders properly.
Check in reduced-motion mode (System Preferences > Accessibility).
  </verify>
  <done>
Card component with hover elevation, Skeleton with shimmer animation, both respect reduced-motion.
  </done>
</task>

</tasks>

<verification>
1. `pnpm run build` completes without TypeScript errors
2. Button scales down on click, springs back
3. Button scales up with shadow on hover (desktop)
4. Card lifts on hover when interactive=true
5. Skeleton shows shimmer animation
6. With prefers-reduced-motion enabled, animations are disabled but components still work
</verification>

<success_criteria>
- Button has pill shape (rounded-full) and 44px minimum touch target
- Button has spring animation on press (scale 0.97) and hover (scale 1.03)
- Card has 16px+ border radius and elevated shadow
- Card lifts on hover when interactive prop is true
- Skeleton shows shimmer gradient animation
- SkeletonCard and SkeletonAvatar convenience components work
- All animations disabled when prefers-reduced-motion is set
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-ui-ux-bilingual-polish/03-02-SUMMARY.md`
</output>
