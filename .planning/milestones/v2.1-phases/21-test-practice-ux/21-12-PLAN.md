---
phase: 21-test-practice-ux
plan: 12
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/PillTabBar.tsx
  - src/components/hub/HubTabBar.tsx
  - src/pages/StudyGuidePage.tsx
  - src/components/test/PreTestScreen.tsx
  - src/components/practice/PracticeConfig.tsx
  - src/components/interview/InterviewSetup.tsx
autonomous: true

must_haves:
  truths:
    - "Generic PillTabBar component with spring-animated sliding pill indicator"
    - "HubTabBar refactored to use PillTabBar (zero visual regression)"
    - "StudyGuidePage tabs use PillTabBar instead of custom 3D button tabs"
    - "PreTestScreen has pill mode selectors for question count"
    - "PracticeConfig question count pills replaced with PillTabBar"
    - "InterviewSetup has PillTabBar mode selector for Practice/Real"
  artifacts:
    - path: "src/components/ui/PillTabBar.tsx"
      provides: "Reusable pill tab bar with spring-animated sliding indicator"
      exports: ["PillTabBar"]
    - path: "src/components/hub/HubTabBar.tsx"
      provides: "HubTabBar refactored to wrap PillTabBar"
    - path: "src/pages/StudyGuidePage.tsx"
      provides: "Study guide using PillTabBar for Browse/Deck/Review tabs"
    - path: "src/components/test/PreTestScreen.tsx"
      provides: "Pre-test screen with pill question count selector"
    - path: "src/components/practice/PracticeConfig.tsx"
      provides: "Practice config with PillTabBar question count pills"
    - path: "src/components/interview/InterviewSetup.tsx"
      provides: "Interview setup with PillTabBar Practice/Real mode selector"
  key_links:
    - from: "src/components/hub/HubTabBar.tsx"
      to: "src/components/ui/PillTabBar.tsx"
      via: "wraps PillTabBar"
      pattern: "PillTabBar"
    - from: "src/pages/StudyGuidePage.tsx"
      to: "src/components/ui/PillTabBar.tsx"
      via: "uses PillTabBar for tab navigation"
      pattern: "PillTabBar"
---

<objective>
Extract HubTabBar's spring-animated pill pattern into a reusable PillTabBar component, then apply it consistently across all pages: study guide tabs, mock test question count selector, practice config pills, and interview mode selector.

Purpose: Create visual consistency across the app by using the same premium pill tab pattern everywhere. Currently HubPage has the polished spring pill, StudyGuidePage has a different 3D button style, and PracticeConfig has plain bordered buttons for count selection. This plan unifies them all.
Output: PillTabBar.tsx generic component, refactored HubTabBar, updated StudyGuidePage/PreTestScreen/PracticeConfig/InterviewSetup
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/21-test-practice-ux/21-CONTEXT.md

@src/components/hub/HubTabBar.tsx
@src/pages/HubPage.tsx
@src/pages/StudyGuidePage.tsx
@src/components/test/PreTestScreen.tsx
@src/components/practice/PracticeConfig.tsx
@src/components/interview/InterviewSetup.tsx
@src/lib/motion-config.ts
@src/lib/i18n/strings.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract PillTabBar generic component and refactor HubTabBar</name>
  <files>src/components/ui/PillTabBar.tsx, src/components/hub/HubTabBar.tsx</files>
  <action>
Create `src/components/ui/PillTabBar.tsx` — a generic, reusable pill tab bar extracted from HubTabBar:

```typescript
interface PillTab {
  id: string;
  label: string;
  labelMy?: string;
  icon?: React.ComponentType<{ className?: string }>;
  badge?: number;  // Optional count badge (e.g., SRS due count)
}

interface PillTabBarProps {
  tabs: PillTab[];
  activeTab: string;
  onTabChange: (tabId: string) => void;
  /** ARIA label for the tablist */
  ariaLabel?: string;
  /** Whether to show Burmese sub-labels */
  showBurmese?: boolean;
  /** Size variant */
  size?: 'sm' | 'md';  // sm = compact for inline selectors, md = full tab bar (default)
  /** Sticky positioning */
  sticky?: boolean;
  /** Custom className for the outer wrapper */
  className?: string;
}
```

Implementation — preserve the exact HubTabBar visual and animation behavior:
- Outer container: `rounded-2xl border border-border/40 bg-surface/80 p-1 backdrop-blur-lg`
- `role="tablist"` with `aria-label`
- Inner grid: `grid grid-cols-{tabs.length}` (dynamic based on tab count)
- **Sliding pill indicator**: `motion.div` with absolute positioning, `bg-primary/10 dark:bg-primary/20 shadow-sm`, width `${100 / tabs.length}%`, animated with `animate={{ x: activeIndex * 100% }}` and `SPRING_SNAPPY` transition
- Each tab button: `role="tab"`, `aria-selected`, min-height 44px touch target
- Active tab: `text-primary` with `scale: 1.05` spring animation
- Inactive tab: `text-text-secondary hover:text-text-primary`
- Burmese sub-label: `font-myanmar text-[10px]` below main label when showBurmese
- Optional icon rendered before label text
- Optional badge: small count pill (bg-warning) positioned absolute top-right of tab
- `size="sm"`: smaller padding, text-xs, min-h-[36px], no Burmese sub-labels regardless
- `size="md"` (default): current HubTabBar sizing
- Sticky variant: wraps in `sticky top-0 z-20` container with margin/padding matching hub
- Reduced motion: disable scale animation, instant pill position (no spring)

**Refactor HubTabBar.tsx** to be a thin wrapper around PillTabBar:

```typescript
export function HubTabBar({ activeTab, onTabChange }: HubTabBarProps) {
  const { showBurmese } = useLanguage();

  const tabs: PillTab[] = [
    { id: 'overview', label: strings.hub.overview.en, labelMy: strings.hub.overview.my },
    { id: 'history', label: strings.hub.history.en, labelMy: strings.hub.history.my },
    { id: 'achievements', label: strings.hub.achievements.en, labelMy: strings.hub.achievements.my },
  ];

  return (
    <PillTabBar
      tabs={tabs}
      activeTab={activeTab}
      onTabChange={onTabChange}
      ariaLabel="Hub tabs"
      showBurmese={showBurmese}
      sticky
    />
  );
}
```

Verify HubPage renders identically before and after refactor (zero visual regression).
  </action>
  <verify>Run `npx tsc --noEmit` and `npm run lint`. Verify HubPage pill tab bar looks and animates identically to before. Verify PillTabBar accepts dynamic tab count (2, 3, 4+ tabs).</verify>
  <done>PillTabBar is a generic reusable component with spring-animated sliding pill. HubTabBar is a thin wrapper with zero visual regression.</done>
</task>

<task type="auto">
  <name>Task 2: Apply PillTabBar to StudyGuidePage, PreTestScreen, PracticeConfig, InterviewSetup</name>
  <files>src/pages/StudyGuidePage.tsx, src/components/test/PreTestScreen.tsx, src/components/practice/PracticeConfig.tsx, src/components/interview/InterviewSetup.tsx</files>
  <action>
**StudyGuidePage.tsx** — Replace the custom 3D button tab bar with PillTabBar:

Current tabs are: Browse (BookOpen icon), Deck (Layers icon, due count badge), Review (GraduationCap icon).

Replace the `tabBar` JSX block (lines ~199-230) with:
```tsx
<PillTabBar
  tabs={[
    { id: '', label: 'Browse', labelMy: 'ကြည့်ရှုရန်', icon: BookOpen },
    { id: '#deck', label: 'Deck', labelMy: 'ကတ်စုပုံ', icon: Layers, badge: dueCount > 0 ? dueCount : undefined },
    { id: '#review', label: 'Review', labelMy: 'ပြန်လည်သုံးသပ်', icon: GraduationCap },
  ]}
  activeTab={activeTab}
  onTabChange={(tabId) => navigate(tabId ? `/study${tabId}` : '/study')}
  ariaLabel="Study guide tabs"
  showBurmese={showBurmese}
/>
```

Keep the existing activeTab derivation logic (from hash). Remove the old `tabBar` const block entirely.

**PreTestScreen.tsx** — Add pill question count selector:

Currently shows just a breathing circle and "I'm Ready" button. Add a question count selector section between the info section and the ready button:

```tsx
<PillTabBar
  tabs={[
    { id: '10', label: '10 Questions', labelMy: 'မေးခွန်း ၁၀' },
    { id: '20', label: '20 Questions', labelMy: 'မေးခွန်း ၂၀' },
  ]}
  activeTab={String(questionCount)}
  onTabChange={(id) => onCountChange(Number(id))}
  ariaLabel="Question count"
  showBurmese={showBurmese}
  size="sm"
/>
```

This requires updating PreTestScreenProps to accept `onCountChange: (count: number) => void` and having TestPage pass it. Update TestPage to manage questionCount state (currently hardcoded — add useState with default 10).

Also add a PillTabBar for test mode info (timed vs. untimed) if TestPage supports both — check if timer is configurable. If questionCount is hardcoded at the parent level, just add the count pills and wire the callback.

**PracticeConfig.tsx** — Replace the bordered-button question count pills with PillTabBar:

Current pills are: Quick (5), Standard (10), Full (all). Replace the `flex gap-2` button group (lines ~328-360) with:

```tsx
<PillTabBar
  tabs={[
    { id: '5', label: `5 · ${strings.practice.quick.en}`, labelMy: strings.practice.quick.my },
    { id: '10', label: `10 · ${strings.practice.standard.en}`, labelMy: strings.practice.standard.my },
    { id: 'full', label: `${selectedQuestionCount} · ${strings.practice.full.en}`, labelMy: strings.practice.full.my },
  ]}
  activeTab={String(countOption)}
  onTabChange={(id) => setCountOption(id === 'full' ? 'full' : Number(id) as 5 | 10)}
  ariaLabel="Question count"
  showBurmese={showBurmese}
  size="sm"
/>
```

Keep the existing selectedCategory gate (pills only show after category selected).

**InterviewSetup.tsx** — Add PillTabBar for Practice/Real mode selection:

Currently uses two large 3D cards for mode selection. Add a PillTabBar above or replacing the card selector:

```tsx
<PillTabBar
  tabs={[
    { id: 'practice', label: 'Practice', labelMy: 'လေ့ကျင့်ရန်', icon: BookOpen },
    { id: 'realistic', label: 'Real Simulation', labelMy: 'စစ်ဆေးမှု', icon: Shield },
  ]}
  activeTab={selectedMode}
  onTabChange={(id) => setSelectedMode(id as InterviewMode)}
  ariaLabel="Interview mode"
  showBurmese={showBurmese}
/>
```

Keep the existing mode cards below as descriptive content — the pill bar becomes the primary selector, the cards become info panels for the selected mode. Add a `selectedMode` state if one doesn't exist. The existing mode cards can transition to showing tips/details for the selected mode (instead of being separate clickable cards).

Add bilingual strings for any new labels to `src/lib/i18n/strings.ts` if they don't exist.
  </action>
  <verify>Run `npx tsc --noEmit`, `npm run lint`, and `npm run build`. Navigate to each page in browser:
- /#/hub — pill tabs look identical to before (regression check)
- /#/study — Browse/Deck/Review pills with sliding indicator, due count badge
- /#/test — question count pills (10/20)
- /#/practice — Quick/Standard/Full pills with sliding indicator
- /#/interview — Practice/Real mode pills with info panels below
</verify>
  <done>PillTabBar applied consistently across all pages. Study guide, mock test, practice config, and interview setup all use the same spring-animated pill pattern as the hub page.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- `npm run lint` passes
- `npm run build` succeeds
- HubPage pill tabs: zero visual regression
- StudyGuidePage: PillTabBar with icons and SRS due count badge
- PreTestScreen: PillTabBar question count selector
- PracticeConfig: PillTabBar replaces bordered-button count pills
- InterviewSetup: PillTabBar Practice/Real mode selector
- All pill bars animate with SPRING_SNAPPY sliding indicator
- Bilingual labels shown when Myanmar mode active
- Reduced motion respected (no spring, instant pill position)
</verification>

<success_criteria>
- Single PillTabBar component used by 5+ pages
- Spring-animated sliding pill indicator on all tab bars
- Consistent visual language across hub, study, test, practice, interview
- Icons and badges supported
- Size variants (sm/md) for inline selectors vs full tab bars
- Zero regression on existing HubPage tabs
</success_criteria>

<output>
After completion, create `.planning/phases/21-test-practice-ux/21-12-SUMMARY.md`
</output>
