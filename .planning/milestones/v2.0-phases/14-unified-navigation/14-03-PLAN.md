---
phase: 14-unified-navigation
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/components/navigation/BottomTabBar.tsx
autonomous: true

must_haves:
  truths:
    - "Mobile users see a 6-tab bottom bar (Home, Study Guide, Mock Test, Interview, Progress Hub, Settings) with 3 utility controls"
    - "Bottom bar has glass-morphism styling matching the sidebar"
    - "Icons are h-6 w-6 (24px) and labels are text-xs (12px)"
    - "Active tab has pill-shaped highlight with primary color"
    - "SRS due count badge appears on Study tab"
  artifacts:
    - path: "src/components/navigation/BottomTabBar.tsx"
      provides: "Refactored mobile bottom tab bar"
      min_lines: 80
  key_links:
    - from: "src/components/navigation/BottomTabBar.tsx"
      to: "src/components/navigation/navConfig.ts"
      via: "NAV_TABS array consumption"
      pattern: "import.*NAV_TABS"
    - from: "src/components/navigation/BottomTabBar.tsx"
      to: "src/components/navigation/NavItem.tsx"
      via: "NavItem component renders each tab"
      pattern: "import.*NavItem"
    - from: "src/components/navigation/BottomTabBar.tsx"
      to: "src/components/navigation/NavigationProvider.tsx"
      via: "useNavigation() for lock state, badges, visibility"
      pattern: "useNavigation\\(\\)"
---

<objective>
Refactor the existing BottomTabBar to use the new nav foundation: consume navConfig for tabs, NavItem for rendering, NavigationProvider for state. Update to 6 tabs, apply glass-morphism, increase icon/label sizes, and add badge support.

Purpose: The mobile bottom bar is the primary navigation on phones. It must match the sidebar's 6-tab structure and glass-morphism styling while keeping its scroll-hide behavior and horizontal scrollability.
Output: Refactored BottomTabBar.tsx
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-unified-navigation/14-CONTEXT.md
@.planning/phases/14-unified-navigation/14-RESEARCH.md
@.planning/phases/14-unified-navigation/14-01-SUMMARY.md
@src/components/navigation/BottomTabBar.tsx
@src/components/navigation/navConfig.ts
@src/components/navigation/NavItem.tsx
@src/components/navigation/NavigationProvider.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor BottomTabBar to use nav foundation</name>
  <files>src/components/navigation/BottomTabBar.tsx</files>
  <action>
Rewrite BottomTabBar.tsx to consume the shared nav foundation from Plan 01. This replaces the current inline `allTabs` array and manual rendering with the centralized config and components.

**Key changes from current implementation:**

1. **Replace `allTabs` array** with `NAV_TABS` from navConfig.ts (6 tabs instead of 8).

2. **Replace inline tab rendering** with `<NavItem>` component for each tab:
   - Pass `variant="mobile"` to NavItem
   - Pass `isActive`, `isLocked`, `showBurmese`, `badges`, `onLockedTap` props
   - NavItem handles icon sizing (h-6 w-6), label sizing (text-xs), active state, tap animation, badge rendering

3. **Get state from NavigationProvider** instead of individual hooks:
   - `const { isLocked, lockMessage, navVisible, badges } = useNavigation();`
   - Remove direct `useScrollDirection()` call (provider handles it)
   - Keep `useLanguage()` for showBurmese (needed for utility controls)
   - Keep `useThemeContext()` for theme toggle
   - Keep `useAuth()` for logout

4. **Apply glass-morphism** per user decision:
   - Replace `bg-card/95 backdrop-blur-xl` with `glass-nav` CSS class
   - Remove the old `border-t border-border/60` (glass-nav handles shadow/glow)

5. **Keep existing behaviors:**
   - Hide on HIDDEN_ROUTES (import from navConfig instead of local constant)
   - Scroll-hide/show: use `navVisible` from NavigationProvider (spring animation already handled)
   - Horizontal scroll with `overflow-x-auto scrollbar-hide`
   - `useScrollSnapCenter` for auto-centering active tab
   - Safe area bottom padding: `env(safe-area-inset-bottom, 0px)`
   - `md:hidden` to hide on desktop/tablet

6. **Utility controls (after separator):**
   - Keep Language toggle, Theme toggle, Logout button
   - Style them consistently with NavItem (h-6 w-6 icons, text-xs labels)
   - Use motion.div whileTap for spring bounce on all utility buttons
   - Separator: `shrink-0 mx-1.5 h-8 w-px bg-border/40`

7. **Lock behavior per user decision:**
   - When isLocked: all nav items are handled by NavItem's lock logic
   - Add a lock warning indicator if isLocked (small warning dot or subtle banner)
   - Locked item tap: NavItem handles shake + toast

8. **Remove unused imports:** Remove direct lucide-react icon imports that are now in navConfig. Remove `useScrollDirection` import (comes from provider). Remove inline `TabItem` interface and `allTabs` constant.

**CSS variable check:** Verify `--bottom-tab-height: 64px` in globals.css is still correct. The increased icon sizes (h-6 from h-4) and label sizes (text-xs from text-[10px]) may increase the bar height slightly. If so, update the CSS variable to match (likely ~68-72px). Measure by checking: icon (24px) + gap (2px) + label (~16px with line-height) + padding (8+8px) = ~58px + safe area. 64px should still work.

The component should NOT import or render `<AppNavigation>` -- that component will be deleted. The BottomTabBar is now the sole mobile nav surface.
  </action>
  <verify>
Run `npx tsc --noEmit` and `npx eslint src/components/navigation/BottomTabBar.tsx --max-warnings 0`. Verify the file no longer contains `allTabs` or inline tab definitions. Verify it imports from navConfig and uses NavItem.
  </verify>
  <done>
BottomTabBar uses NAV_TABS (6 tabs), NavItem for rendering, NavigationProvider for state. Glass-morphism applied via glass-nav class. Icons are h-6 w-6, labels are text-xs. Badge support via NavItem. Lock behavior via NavigationProvider. Horizontal scroll and scroll-hide preserved. No more inline tab array duplication.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- `npx eslint src/components/navigation/BottomTabBar.tsx --max-warnings 0` passes
- File imports from `navConfig.ts`, `NavItem.tsx`, `NavigationProvider.tsx`
- File does NOT contain `allTabs` constant or inline icon imports for nav tabs
- File has `md:hidden` class on the nav element
- File uses `glass-nav` CSS class
</verification>

<success_criteria>
BottomTabBar is refactored to use the shared nav foundation. Zero code duplication with Sidebar (both consume navConfig + NavItem). Glass-morphism applied. Compiles and lints cleanly.
</success_criteria>

<output>
After completion, create `.planning/phases/14-unified-navigation/14-03-SUMMARY.md`
</output>
