---
phase: 12-uscis-2025-question-bank
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/update/UpdateBanner.tsx
  - src/components/update/WhatsNewModal.tsx
autonomous: true

must_haves:
  truths:
    - "A bilingual 'Updated for USCIS 2025 Civics Test - 128 Questions' banner is visible"
    - "Existing users see a one-time dismissible What's New modal highlighting 8 new questions, 2025 update, and state personalization"
    - "What's New modal is never shown again after dismissal (localStorage flag)"
    - "Banner and modal have both English and Burmese text"
  artifacts:
    - path: "src/components/update/UpdateBanner.tsx"
      provides: "Thin bilingual banner component"
      exports: ["UpdateBanner"]
    - path: "src/components/update/WhatsNewModal.tsx"
      provides: "One-time dismissible What's New modal"
      exports: ["WhatsNewModal"]
  key_links:
    - from: "src/components/update/WhatsNewModal.tsx"
      to: "localStorage"
      via: "civic-prep-whats-new-2025-seen key"
      pattern: "whats-new-2025"
---

<objective>
Create the USCIS 2025 update indicator UI components.

Purpose: Satisfies USCIS-04 (version indicator). Users see that the app has been updated for the USCIS 2025 civics test, with 128 questions. Existing users get a one-time What's New splash.

Output: UpdateBanner and WhatsNewModal components, ready to be placed on pages in Plan 04.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-uscis-2025-question-bank/12-RESEARCH.md
@src/components/pwa/WelcomeModal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create UpdateBanner component</name>
  <files>
    src/components/update/UpdateBanner.tsx
  </files>
  <action>
Create `src/components/update/` directory and `UpdateBanner.tsx`.

A thin, non-intrusive bilingual banner that can be placed at the top of pages.

Design:
- Thin horizontal bar with subtle background (use semantic tokens: `bg-primary-subtle`, `border-b border-primary/20`)
- Two lines of centered text:
  - EN: "Updated for USCIS 2025 Civics Test — 128 Questions" (text-xs font-semibold text-primary)
  - MY: "USCIS 2025 နိုင်ငံသားရေးရာစာမေးပွဲအတွက် မွမ်းမံပြီး — မေးခွန်း ၁၂၈ ခု" (font-myanmar text-xs text-primary/80)
- Compact padding: `px-4 py-1.5`
- Accept `showBurmese` prop (from LanguageContext) to conditionally show Burmese line
- Optional `className` prop for positioning customization

Props interface:
```typescript
interface UpdateBannerProps {
  showBurmese?: boolean;
  className?: string;
}
```

Keep it simple -- no dismiss button, no animation. This is an informational badge that stays visible.
  </action>
  <verify>
1. `npx tsc --noEmit` passes
2. `npx eslint src/components/update/UpdateBanner.tsx --no-warn-ignored` passes
3. File exports `UpdateBanner` component
  </verify>
  <done>
- UpdateBanner renders bilingual "Updated for USCIS 2025" text
- Uses semantic design tokens (no dark: overrides needed)
- Accepts showBurmese and className props
  </done>
</task>

<task type="auto">
  <name>Task 2: Create WhatsNewModal component</name>
  <files>
    src/components/update/WhatsNewModal.tsx
  </files>
  <action>
Create `WhatsNewModal.tsx` following the `WelcomeModal.tsx` pattern.

**Behavior:**
- Shown once for existing users (check `localStorage` key `civic-prep-whats-new-2025-seen`)
- On dismiss: set localStorage flag to `'true'`, never show again
- Only show to users who have existing data (check `localStorage` for any `civic-prep-*` key presence -- if no keys exist, user is brand new and doesn't need What's New)

**Content (bilingual):**
- Header: "What's New" / "ဘာအသစ်တွေရှိလဲ"
- Icon: Sparkles from lucide-react
- 3 feature cards/bullets:
  1. **128 Questions** / "မေးခွန်း ၁၂၈ ခု"
     "8 new civics questions added to match the official USCIS 2025 test."
     "USCIS 2025 စာမေးပွဲနှင့် ကိုက်ညီရန် နိုင်ငံသားရေးရာမေးခွန်း ၈ ခု ထပ်ထည့်ထားသည်။"
  2. **USCIS 2025 Updated** / "USCIS 2025 မွမ်းမံပြီး"
     "All questions verified against the latest USCIS 2025 civics test content."
     "မေးခွန်းအားလုံးကို နောက်ဆုံး USCIS 2025 နိုင်ငံသားရေးရာ အကြောင်းအရာနှင့် စစ်ဆေးပြီးဖြစ်သည်။"
  3. **State Personalization** / "ပြည်နယ်ပုဂ္ဂိုလ်ရေးသတ်မှတ်ခြင်း"
     "Select your state to see your governor, senators, and state capital in study questions."
     "သင့်ပြည်နယ်ကို ရွေးချယ်ပြီး လေ့လာမေးခွန်းများတွင် သင့်အုပ်ချုပ်ရေးမှူး၊ အထက်လွှတ်တော်အမတ်များနှင့် ပြည်နယ်မြို့တော်ကို ကြည့်ပါ။"

**Design:**
- Full-screen overlay with backdrop blur (similar to WelcomeModal)
- Rounded card in center, max-w-md
- Use semantic tokens: bg-surface, text-foreground, border-border
- Close button (X icon) in top-right corner
- "Got it!" / "ရပြီ!" dismiss button at bottom
- Scrollable content area for small screens
- IMPORTANT: Use `pointer-events-none` wrapper + `pointer-events-auto` content per MEMORY.md pattern for modal pointer events

**Props:**
```typescript
interface WhatsNewModalProps {
  onClose: () => void;
}
```

Export a wrapper hook or component that handles the localStorage check logic:
```typescript
export function useWhatsNew(): { showWhatsNew: boolean; dismissWhatsNew: () => void }
```

This hook:
- Returns `showWhatsNew: true` only if:
  1. localStorage key `civic-prep-whats-new-2025-seen` is NOT `'true'`
  2. User has existing app data (any `civic-prep-*` key in localStorage -- indicates returning user)
- `dismissWhatsNew` sets the localStorage flag
  </action>
  <verify>
1. `npx tsc --noEmit` passes
2. `npx eslint src/components/update/WhatsNewModal.tsx --no-warn-ignored` passes
3. File exports `WhatsNewModal` and `useWhatsNew`
4. No React Compiler violations (no setState in effects, no ref.current in render)
  </verify>
  <done>
- WhatsNewModal shows 3 bilingual feature highlights
- useWhatsNew hook manages show/dismiss logic with localStorage
- Only shown to returning users (not brand-new users)
- Dismissed permanently after close
- Follows WelcomeModal pattern with proper pointer-events handling
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. `npx eslint src/components/update/ --no-warn-ignored` passes
3. UpdateBanner and WhatsNewModal exported correctly
4. No hardcoded dark: overrides -- all semantic tokens
5. WhatsNewModal localStorage logic prevents re-showing
</verification>

<success_criteria>
- UpdateBanner displays bilingual USCIS 2025 update text with 128 question count
- WhatsNewModal highlights 3 features: 128 questions, USCIS 2025, state personalization
- Modal shown once per user, dismissed permanently
- Components use semantic design tokens
- Ready for integration into pages (Plan 04)
</success_criteria>

<output>
After completion, create `.planning/phases/12-uscis-2025-question-bank/12-03-SUMMARY.md`
</output>
