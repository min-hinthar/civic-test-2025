---
phase: 05-spaced-repetition
plan: 08
type: execute
wave: 4
depends_on: ["05-03"]
files_modified:
  - src/components/srs/SRSWidget.tsx
  - src/components/srs/ReviewHeatmap.tsx
  - src/pages/Dashboard.tsx
autonomous: true

must_haves:
  truths:
    - "User sees due card count on dashboard in a compact SRS widget"
    - "User can expand widget to see review streak, category breakdown, and review heatmap"
    - "Tapping the widget navigates to study guide review tab"
    - "Widget shows context-aware empty state when deck is empty vs all caught up"
  artifacts:
    - path: "src/components/srs/SRSWidget.tsx"
      provides: "Dashboard SRS widget (compact + expandable)"
      exports: ["SRSWidget"]
    - path: "src/components/srs/ReviewHeatmap.tsx"
      provides: "GitHub-style activity heatmap for review history"
      exports: ["ReviewHeatmap"]
  key_links:
    - from: "src/components/srs/SRSWidget.tsx"
      to: "src/hooks/useSRSWidget.ts"
      via: "useSRSWidget() for widget data"
      pattern: "useSRSWidget"
    - from: "src/pages/Dashboard.tsx"
      to: "src/components/srs/SRSWidget.tsx"
      via: "SRSWidget rendered in dashboard"
      pattern: "SRSWidget"
    - from: "src/components/srs/SRSWidget.tsx"
      to: "/study#deck"
      via: "navigate to study guide review"
      pattern: "navigate.*study.*deck"
---

<objective>
Create the Dashboard SRS widget with compact/expanded states and the GitHub-style review heatmap, then integrate into the Dashboard page.

Purpose: Users need to see their SRS status at a glance on the dashboard (per locked decision: compact by default, expandable). The widget is the primary entry point for daily review.
Output: SRSWidget and ReviewHeatmap components integrated into Dashboard.
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-spaced-repetition/05-RESEARCH.md
@src/pages/Dashboard.tsx
@src/hooks/useSRSWidget.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ReviewHeatmap and SRSWidget components</name>
  <files>
    src/components/srs/ReviewHeatmap.tsx
    src/components/srs/SRSWidget.tsx
  </files>
  <action>
    1. Create `src/components/srs/ReviewHeatmap.tsx`:
       **Props:** `{ deck: SRSCardRecord[]; className?: string }`

       **Implementation (per locked decision: GitHub-style activity grid):**
       - Build a heatmap of review activity from deck's lastReviewedAt dates
       - Days range: 60 days on desktop, 30 days on mobile (per discretion recommendation). Use CSS media query or a simple responsive check.
       - Data structure: Map of date string (YYYY-MM-DD) -> review count for that day
       - Iterate deck, group by lastReviewedAt date, count reviews per day
       - CSS Grid layout: 7 rows (days of week) x N columns (weeks)
       - Each cell: small square (~12px on mobile, ~16px desktop) with background color intensity based on review count
         - 0 reviews: `bg-muted/30`
         - 1-2 reviews: `bg-primary-200 dark:bg-primary-800`
         - 3-5 reviews: `bg-primary-400 dark:bg-primary-600`
         - 6+ reviews: `bg-primary-500 dark:bg-primary-500`
       - Day labels on left (Mon, Wed, Fri abbreviated)
       - Month labels on top
       - Rounded corners on cells (rounded-sm)
       - No external library -- pure CSS grid + Tailwind (per research: simple enough for mobile 30-60 day range)
       - Bilingual day abbreviations (Mon/တနင်္လာ etc.) -- use useLanguage

    2. Create `src/components/srs/SRSWidget.tsx`:
       **Props:** `{ className?: string }`

       **Data:** Use `useSRSWidget()` for dueCount, reviewStreak, categoryBreakdown, isEmpty, isAllCaughtUp, nextDueText
       Use `useSRS()` for deck (passed to ReviewHeatmap)

       **Compact state (per locked decision: compact by default):**
       - Card with icon (BookCheck or similar from lucide-react)
       - Due count prominent: "X Due for Review / ပြန်လှည့်ရန် X ကတ်"
       - Review streak (if > 0): flame icon + "X day streak / X ရက်ဆက်တိုက်"
       - Expand chevron (ChevronDown) to toggle expanded view
       - Tap/click navigates to `/study#deck` (per locked decision: widget taps navigate to study guide review tab)
       - But expand button should NOT navigate -- it just toggles expanded view. Use stopPropagation on expand button.

       **Expanded state (per locked decision: due count, review streak, category breakdown, review heatmap):**
       - Due count (already visible in compact)
       - Review streak with bilingual message:
         - 0 days: "Start your review streak! / ပြန်လှည့်ခြင်းစတင်ပါ!"
         - 1-6 days: "X day streak - keep going! / X ရက်ဆက်တိုက် - ဆက်ကြိုးစားပါ!"
         - 7+ days: "X day streak - amazing! / X ရက်ဆက်တိုက် - အံ့ဩစရာ!"
       - Category breakdown: mini list showing category name + due count badge for each category with cards. Only show categories that have cards in deck.
       - ReviewHeatmap component
       - Collapse chevron (ChevronUp)

       **Context-aware empty state (per locked decision):**
       - If `isEmpty` (no cards in deck): "Add questions to start reviewing! / မေးခွန်းများထည့်ပြီး ပြန်လှည့်ခြင်းစတင်ပါ!" with link to study guide
       - If `isAllCaughtUp` (cards exist but none due): "All caught up! / အားလုံးပြီးပါပြီ!" + next due time from `nextDueText`. Encouraging green checkmark.

       **Visual:**
       - Use Card component with glass-panel styling
       - Collapse/expand with motion/react AnimatePresence + height animation
       - Consistent with existing dashboard cards (CategoryGrid, ReadinessIndicator)
  </action>
  <verify>
    - `pnpm exec tsc --noEmit` passes
    - SRSWidget renders in both compact and expanded states
    - ReviewHeatmap renders a CSS grid
  </verify>
  <done>
    - SRSWidget compact: due count + streak, tappable to navigate to review
    - SRSWidget expanded: due count, streak with bilingual messages, category breakdown, heatmap
    - ReviewHeatmap: GitHub-style CSS grid, responsive day range (30/60 days)
    - Context-aware empty states (no cards vs all caught up)
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate SRSWidget into Dashboard page</name>
  <files>src/pages/Dashboard.tsx</files>
  <action>
    1. Import SRSWidget in Dashboard.tsx
    2. Add `<SRSWidget />` to the Dashboard layout:
       - Place it prominently -- after the greeting section and ReadinessIndicator, before the CategoryGrid
       - Or alongside ReadinessIndicator in a responsive grid (side by side on desktop, stacked on mobile)
       - The SRS widget should feel like a "daily action" prompt -- the first thing users want to do when they open the app
    3. Wrap in FadeIn animation for consistent staggered entry with other dashboard sections
    4. The widget is self-contained -- it uses hooks internally, no props needed from Dashboard
    5. Import `useSRS` context and show due count in the section header if desired, but the widget handles its own display

    NOTE: Do not modify the existing CategoryGrid, ReadinessIndicator, or SuggestedFocus sections. Only ADD the SRSWidget.
  </action>
  <verify>
    - `pnpm exec tsc --noEmit` passes
    - Dashboard renders SRSWidget
    - SRSWidget visible on dashboard page
  </verify>
  <done>
    - Dashboard displays SRSWidget prominently
    - Widget loads SRS data via context hooks
    - Compact view shows due count and streak at a glance
    - Tap navigates to study guide review tab
    - Consistent visual integration with existing dashboard sections
  </done>
</task>

</tasks>

<verification>
- `pnpm exec tsc --noEmit` passes
- Dashboard includes SRSWidget
- SRSWidget compact/expanded toggle works
- ReviewHeatmap CSS grid renders
- No ESLint errors
</verification>

<success_criteria>
- User sees "due for review" count on dashboard (Success Criterion 1)
- Widget is compact by default, expandable to show streak, breakdown, heatmap
- Tapping widget navigates to study guide review tab
- Heatmap shows review activity over 30-60 days
- Context-aware empty states guide users appropriately
- Review streak tracks daily review habit separately from study streak
</success_criteria>

<output>
After completion, create `.planning/phases/05-spaced-repetition/05-08-SUMMARY.md`
</output>
