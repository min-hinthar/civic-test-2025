---
phase: 04-learning-explanations-category-progress
plan: 07
type: execute
wave: 4
depends_on: ["04-02", "04-06"]
files_modified:
  - src/pages/ProgressPage.tsx
  - src/pages/Dashboard.tsx
  - src/AppShell.tsx
autonomous: true

must_haves:
  truths:
    - "User sees dedicated progress page with overall readiness score and per-category detail"
    - "User sees mastery trend line chart on progress page"
    - "User can expand categories to see individual question accuracy"
    - "Dashboard shows collapsible 'Category Progress' section with compact category grid"
    - "Progress page accessible from dashboard link (not bottom nav tab)"
  artifacts:
    - path: "src/pages/ProgressPage.tsx"
      provides: "Dedicated progress page with readiness score, category rings, trend chart, question drill-down"
      exports: ["default"]
    - path: "src/pages/Dashboard.tsx"
      provides: "Dashboard with collapsible Category Progress section"
      contains: "CategoryGrid"
    - path: "src/AppShell.tsx"
      provides: "Route for /progress page"
      contains: "ProgressPage"
  key_links:
    - from: "src/pages/ProgressPage.tsx"
      to: "src/hooks/useCategoryMastery.ts"
      via: "useCategoryMastery hook"
      pattern: "useCategoryMastery"
    - from: "src/pages/ProgressPage.tsx"
      to: "recharts"
      via: "LineChart for mastery trend"
      pattern: "LineChart"
    - from: "src/pages/Dashboard.tsx"
      to: "src/components/progress/CategoryGrid.tsx"
      via: "CategoryGrid component import"
      pattern: "CategoryGrid"
    - from: "src/AppShell.tsx"
      to: "src/pages/ProgressPage.tsx"
      via: "Route component"
      pattern: 'path="/progress"'
---

<objective>
Create the dedicated progress page with full category detail and add a collapsible category progress section to the dashboard.

Purpose: Users track their mastery by USCIS category with visual progress rings, trend charts, and per-question accuracy drill-down. The dashboard provides at-a-glance progress while the dedicated page enables deep analysis.

Output: ProgressPage at /progress route, enhanced Dashboard with Category Progress section.
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-learning-explanations-category-progress/04-CONTEXT.md
@src/pages/Dashboard.tsx
@src/AppShell.tsx
@src/hooks/useCategoryMastery.ts
@src/components/progress/CategoryGrid.tsx
@src/components/progress/CategoryRing.tsx
@src/components/dashboard/ReadinessIndicator.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dedicated ProgressPage with readiness score, category detail, and trend chart</name>
  <files>src/pages/ProgressPage.tsx, src/AppShell.tsx</files>
  <action>
    1. **Create ProgressPage.tsx** at `src/pages/ProgressPage.tsx`:

       **Layout (top to bottom):**

       a. **Page header:**
          - PageTitle with bilingual "Category Progress / အမျိုးအစား တိုးတက်မှု"
          - AppNavigation at top

       b. **Overall readiness score (prominent at top):**
          - Large centered readiness display
          - Connect to existing ReadinessIndicator logic OR create simpler display showing overall mastery %
          - Claude's discretion on how to connect dashboard ReadinessIndicator with progress page (per CONTEXT.md)
          - Show overall mastery as large animated number with CategoryRing around it
          - Below: "X of 100 questions practiced" count

       c. **Category cards (3 main USCIS categories):**
          - For each category: Card with CategoryRing (large, 120px), category name bilingual, MasteryBadge
          - Distinct colors: blue (Government), amber (History), emerald (Civics)
          - Expandable sub-categories with horizontal progress bars
          - Within each sub-category: expandable individual questions
          - **Question rows show** (per CONTEXT.md): question text + historical accuracy percentage (e.g., "3/5 correct (60%)")
          - Use StaggeredList for card entrance animation

       d. **"Practice this category" button on each category card:**
          - Shows current mastery % + improvement potential text
          - Links to practice mode with this category pre-selected
          - e.g., "Practice American Government (72%) / အမေရိကန်အစိုးရ လေ့ကျင့်ပါ"

       e. **Mastery trend line chart:**
          - Uses recharts (already installed, already used in HistoryPage)
          - Shows mastery % over time for each main category as separate lines
          - Distinct line colors matching category colors
          - Responsive container for mobile
          - Only shows if user has > 1 data point

       f. **Back to dashboard link:**
          - "Back to Dashboard / ဒက်ရှ်ဘုတ်သို့" with ChevronLeft icon

    2. **Add /progress route to AppShell.tsx:**
       - Import ProgressPage
       - Add route: `<Route path="/progress" element={<ProtectedRoute><ProgressPage /></ProtectedRoute>} />`
       - Place after /history route
  </action>
  <verify>
    `npx tsc --noEmit` passes. Navigate to /progress - see readiness score, category cards with rings, expandable questions, trend chart. Route is protected.
  </verify>
  <done>
    ProgressPage renders at /progress with: overall readiness score, 3 USCIS category cards with animated rings, expandable sub-categories with question accuracy rows, mastery trend line chart, and "Practice this category" buttons. Route is registered and protected.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add collapsible Category Progress section to Dashboard</name>
  <files>src/pages/Dashboard.tsx</files>
  <action>
    1. **Add collapsible "Category Progress" section to Dashboard:**
       - Position: below the existing stats cards, above the "Ready for the Test?" section
       - Section header: SectionHeading with bilingual "Category Progress / အမျိုးအစား တိုးတက်မှု"
       - Collapsible: use useState with localStorage persistence for collapse state
       - Collapsed state: shows just the header + chevron + summary text ("3 categories, 72% average")
       - Expanded state: renders CategoryGrid component with compact rings for each category

    2. **CategoryGrid integration:**
       - Import CategoryGrid and useCategoryMastery
       - Pass `onCategoryClick` to navigate to progress page with category focus
       - Show loading skeleton while mastery data loads from IndexedDB

    3. **"View Full Progress" link:**
       - Below the CategoryGrid, add a link to /progress page
       - Uses BilingualButton with outline variant
       - Text: "View Full Progress / အပြည့်အစုံကြည့်ပါ"

    4. **Milestone celebration integration:**
       - Import useMasteryMilestones and MasteryMilestone
       - Render MasteryMilestone modal at Dashboard level
       - **Data flow:** Dashboard calls `useCategoryMastery()` which returns `{ categoryMasteries, ... }`. Then Dashboard passes `categoryMasteries` directly to `useMasteryMilestones(categoryMasteries)`. The milestone hook does NOT call useCategoryMastery internally -- it receives the data as a parameter to avoid duplicate IndexedDB reads.
       - Pattern:
         ```typescript
         const { categoryMasteries, isLoading } = useCategoryMastery();
         const milestone = useMasteryMilestones(categoryMasteries);
         ```
       - When milestone detected (non-null return), render `<MasteryMilestone milestone={milestone} onDismiss={...} />`

    5. **FadeIn animation on section load:**
       - Use FadeIn component from animations/StaggeredList for the progress section
  </action>
  <verify>
    `npx tsc --noEmit` passes. Dashboard shows Category Progress section with compact rings. Section is collapsible. "View Full Progress" link navigates to /progress. Milestone celebrations trigger on threshold crossings.
  </verify>
  <done>
    Dashboard has collapsible "Category Progress" section with CategoryGrid showing compact rings for all 3 USCIS categories. "View Full Progress" link navigates to /progress. Milestone celebrations trigger when mastery crosses 50/75/100% thresholds.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. /progress page shows overall readiness, category rings, expandable question list, trend chart
3. Dashboard shows collapsible Category Progress section
4. Category progress section persists collapse state
5. "View Full Progress" link navigates to /progress
6. Milestone celebrations trigger at 50/75/100% thresholds
7. All text is bilingual
</verification>

<success_criteria>
- ProgressPage renders at /progress with full category detail
- Dashboard shows compact category progress with collapsible section
- Trend chart renders with recharts (matching HistoryPage pattern)
- Milestone celebration modal works on Dashboard
- Protected route requires authentication
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-learning-explanations-category-progress/04-07-SUMMARY.md`
</output>
