---
phase: 06-interview-simulation
plan: 03
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - src/pages/InterviewPage.tsx
  - src/components/interview/InterviewSetup.tsx
  - src/components/interview/InterviewCountdown.tsx
  - src/components/interview/InterviewerAvatar.tsx
  - src/components/AppNavigation.tsx
  - src/AppShell.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /interview from top-level navigation"
    - "Interview page shows setup screen with Realistic and Practice mode cards"
    - "Setup screen shows expandable 'What to Expect' tips section"
    - "Setup screen shows recent interview scores if any exist"
    - "User sees 3-2-1 countdown animation before interview starts"
    - "Interviewer silhouette icon is visible on setup screen"
  artifacts:
    - path: "src/pages/InterviewPage.tsx"
      provides: "Interview page with setup/session/results state machine"
      exports: ["default"]
    - path: "src/components/interview/InterviewSetup.tsx"
      provides: "Mode selection cards, tips, recent scores"
      exports: ["InterviewSetup"]
    - path: "src/components/interview/InterviewCountdown.tsx"
      provides: "3-2-1 visual countdown component"
      exports: ["InterviewCountdown"]
    - path: "src/components/interview/InterviewerAvatar.tsx"
      provides: "Silhouette icon with pulse animation"
      exports: ["InterviewerAvatar"]
    - path: "src/components/AppNavigation.tsx"
      provides: "Interview nav link"
      contains: "/interview"
    - path: "src/AppShell.tsx"
      provides: "Interview route"
      contains: "InterviewPage"
  key_links:
    - from: "src/AppShell.tsx"
      to: "src/pages/InterviewPage.tsx"
      via: "Route component"
      pattern: "path=.*interview.*InterviewPage"
    - from: "src/components/AppNavigation.tsx"
      to: "/interview"
      via: "navLinks array"
      pattern: "href.*interview"
    - from: "src/components/interview/InterviewSetup.tsx"
      to: "src/lib/interview/interviewStore.ts"
      via: "getInterviewHistory for recent scores"
      pattern: "getInterviewHistory"
---

<objective>
Create the interview page with its state machine, setup screen, countdown, and navigation integration.

Purpose: Users need to discover and access the interview feature via top-level navigation. The setup screen lets them choose between Realistic and Practice modes, understand what to expect, see past scores, and start with a proper countdown.

Output: InterviewPage with state machine (setup -> countdown -> session -> results), InterviewSetup component, InterviewCountdown component, InterviewerAvatar component, and navigation/routing integration.
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-interview-simulation/06-CONTEXT.md
@.planning/phases/06-interview-simulation/06-RESEARCH.md
@.planning/phases/06-interview-simulation/06-01-SUMMARY.md

@src/AppShell.tsx
@src/components/AppNavigation.tsx
@src/pages/PracticePage.tsx
@src/lib/i18n/strings.ts
@src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: InterviewPage state machine, navigation, and routing</name>
  <files>
    src/pages/InterviewPage.tsx
    src/components/AppNavigation.tsx
    src/AppShell.tsx
  </files>
  <action>
    1. Create `src/pages/InterviewPage.tsx` following PracticePage state machine pattern:
       - State machine: `type InterviewPhase = 'setup' | 'countdown' | 'session' | 'results'`
       - State: phase (InterviewPhase), mode (InterviewMode), results (InterviewResult[]), sessionDuration (number)
       - Render AppNavigation with `locked={phase === 'session' && mode === 'realistic'}` (realistic mode cannot quit)
       - Phase rendering:
         - `setup`: render InterviewSetup with `onStart={(mode) => { setMode(mode); setPhase('countdown'); }}`
         - `countdown`: render InterviewCountdown with `onComplete={() => setPhase('session')}`
         - `session`: render placeholder div with "Interview session coming in plan 06-04" (will be replaced by plan 04)
         - `results`: render placeholder div with "Interview results coming in plan 06-05" (will be replaced by plan 05)
       - handleRetry callback: resets results, sets phase back to 'setup'
       - Wrap in standard page-shell layout (min-h-screen bg-background)

    2. Add interview to navigation in `src/components/AppNavigation.tsx`:
       - Add to navLinks array AFTER mockTest, BEFORE testHistory:
         `{ href: '/interview', label: strings.nav.practiceInterview }`
       - Note: strings.nav.practiceInterview was added in plan 01

    3. Add interview route to `src/AppShell.tsx`:
       - Import InterviewPage: `import InterviewPage from '@/pages/InterviewPage'`
       - Add route AFTER practice route:
         ```
         <Route path="/interview" element={<ProtectedRoute><InterviewPage /></ProtectedRoute>} />
         ```
  </action>
  <verify>Run `npx tsc --noEmit`. Navigate to /interview in the app. Verify the setup screen renders. Verify "Interview" appears in navigation. Verify clicking "Interview" navigates to /interview.</verify>
  <done>InterviewPage exists at /interview with state machine skeleton. Navigation includes "Interview" link. Route is protected behind authentication.</done>
</task>

<task type="auto">
  <name>Task 2: InterviewSetup, InterviewCountdown, and InterviewerAvatar</name>
  <files>
    src/components/interview/InterviewSetup.tsx
    src/components/interview/InterviewCountdown.tsx
    src/components/interview/InterviewerAvatar.tsx
  </files>
  <action>
    1. Create `src/components/interview/InterviewerAvatar.tsx`:
       - Props: `isSpeaking?: boolean`, `size?: number` (default 64)
       - Render inline SVG: simple person silhouette (head circle + shoulder arc) inside a rounded circle
       - Background: subtle gradient using primary-100 to primary-200
       - Silhouette fill: primary-500
       - When `isSpeaking=true`: pulse animation using motion/react `animate={{ opacity: [0.6, 1, 0.6] }}` with `transition={{ repeat: Infinity, duration: 1.5 }}`
       - When not speaking: static opacity 0.7
       - Respect reduced motion via `useReducedMotion` hook

    2. Create `src/components/interview/InterviewSetup.tsx`:
       - Props: `onStart: (mode: InterviewMode) => void`
       - Layout: centered content with max-w-2xl
       - Components:
         a. **Page title**: BilingualHeading with strings.interview.practiceInterview
         b. **InterviewerAvatar** centered at top (decorative, not speaking)
         c. **Mode selection**: Two Card components side by side (stack on mobile):
            - **Realistic Interview card**: Icon (e.g., Shield or similar), title using strings.interview.realisticMode, subtitle using strings.interview.realisticTip, onClick calls onStart('realistic'). Styled with primary accent border on hover.
            - **Practice Interview card**: Icon (e.g., BookOpen), title using strings.interview.practiceMode, subtitle using strings.interview.practiceTip, onClick calls onStart('practice'). Styled with accent border on hover.
         d. **"What to Expect" section**: Collapsible/expandable section (use state + ChevronDown icon rotation):
            - Realistic mode tips: "20 questions, 15 seconds each", "Like the real USCIS interview", "Cannot pause or quit", "Stops when you pass (12 correct) or fail (9 incorrect)"
            - Practice mode tips: "20 questions at your own pace", "See explanations after each question", "Pause or quit anytime", "Add cards to your review deck"
            - Tips displayed as bilingual text using BilingualText
         e. **Recent scores section**: Load interview history via `getInterviewHistory()` in useEffect. Show last 3-5 sessions as small cards with: date, mode icon, score (X/20), pass/fail badge. If no history, show encouraging "First time? Give it a try!" message.
       - Request microphone permission during setup: call `navigator.mediaDevices.getUserMedia({ audio: true })` proactively wrapped in try-catch. Show a brief mic permission notice. If denied, show subtle note "Recording unavailable - answer verbally". Store permission result to pass down to session.

    3. Create `src/components/interview/InterviewCountdown.tsx`:
       - Props: `onComplete: () => void`
       - Display: large centered numbers 3, 2, 1 then "Begin" text
       - Animation: each number uses motion/react `scale` animation (2.0 -> 1.0) with spring physics from design tokens (stiffness: 400, damping: 17)
       - Each number shows for 1 second, then fades out and next appears
       - After "Begin" shows for 0.8 seconds, call onComplete
       - Use useEffect with setTimeout chain (or setInterval with counter)
       - Respect reduced motion: show numbers without scale animation, just opacity
       - Background: full-screen overlay with semi-transparent backdrop
       - InterviewerAvatar visible behind/above the countdown numbers
  </action>
  <verify>Run `npx tsc --noEmit`. Navigate to /interview. Verify two mode cards appear. Verify clicking a mode card shows countdown. Verify countdown goes 3-2-1-Begin then transitions.</verify>
  <done>Setup screen shows Realistic and Practice mode cards with tips and recent scores. Countdown displays 3-2-1-Begin with spring animation. InterviewerAvatar renders as SVG silhouette with pulse capability.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. /interview route accessible and shows setup screen
3. "Interview" nav link visible in AppNavigation (desktop and mobile)
4. Two mode selection cards render with bilingual text
5. "What to Expect" section expands/collapses
6. Countdown plays 3-2-1-Begin sequence
7. InterviewerAvatar renders without errors
8. Realistic mode: navigation is locked during session phase
</verification>

<success_criteria>
Interview page is accessible via navigation, setup screen presents both modes with tips and history, countdown animation works, and the page state machine transitions between setup and countdown phases.
</success_criteria>

<output>
After completion, create `.planning/phases/06-interview-simulation/06-03-SUMMARY.md`
</output>
