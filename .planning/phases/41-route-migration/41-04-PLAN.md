---
phase: 41-route-migration
plan: 04
type: execute
wave: 2
depends_on:
  - 41-01
files_modified:
  - src/components/dashboard/CategoryPreviewCard.tsx
  - src/components/dashboard/CompactStatRow.tsx
  - src/components/dashboard/DashboardEmptyState.tsx
  - src/components/dashboard/NBAHeroCard.tsx
  - src/components/dashboard/RecentActivityCard.tsx
  - src/components/hub/AchievementsTab.tsx
  - src/components/hub/HistoryTab.tsx
  - src/components/hub/OverviewTab.tsx
  - src/components/hub/WelcomeState.tsx
  - src/components/srs/DeckManager.tsx
  - src/components/srs/ReviewDeckCard.tsx
  - src/components/srs/ReviewSession.tsx
  - src/components/srs/SRSWidget.tsx
  - src/components/interview/InterviewResults.tsx
  - src/components/practice/PracticeResults.tsx
  - src/components/test/PreTestScreen.tsx
  - src/components/results/TestResultsScreen.tsx
  - src/components/sessions/UnfinishedBanner.tsx
  - src/components/social/BadgeHighlights.tsx
  - src/components/onboarding/OnboardingTour.tsx
autonomous: true
requirements:
  - MIGR-05
  - MIGR-06

must_haves:
  truths:
    - "All dashboard components use next/navigation and next/link instead of react-router-dom"
    - "All hub tab components use next/navigation instead of react-router-dom"
    - "All SRS components use next/navigation instead of react-router-dom"
    - "Badge deep-linking uses search params instead of location.state"
    - "All remaining component files have zero react-router-dom imports"
  artifacts:
    - path: "src/components/hub/AchievementsTab.tsx"
      provides: "Achievements tab with search param badge linking"
      contains: "useSearchParams"
    - path: "src/components/social/BadgeHighlights.tsx"
      provides: "Badge highlights with search param navigation"
      contains: "searchParams"
  key_links:
    - from: "src/components/social/BadgeHighlights.tsx"
      to: "next/navigation"
      via: "router.push with focusBadge search param"
      pattern: "focusBadge"
    - from: "src/components/dashboard/NBAHeroCard.tsx"
      to: "next/link"
      via: "Link component"
      pattern: "from 'next/link'"
---

<objective>
Migrate all remaining component files (~20 files) from react-router-dom to next/navigation: dashboard components, hub tabs, SRS components, interview results, practice results, test components, sessions, social, and onboarding. This completes the component-level migration.

Purpose: After this plan + Plan 03, every source file in src/ uses next/navigation instead of react-router-dom, making the final cleanup (Plan 05) safe.
Output: 20 migrated component files with zero react-router-dom imports.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-route-migration/41-CONTEXT.md
@.planning/phases/41-route-migration/41-RESEARCH.md
@.planning/phases/41-route-migration/41-INTEGRATION-MAP.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate dashboard and hub components</name>
  <files>
    src/components/dashboard/CategoryPreviewCard.tsx
    src/components/dashboard/CompactStatRow.tsx
    src/components/dashboard/DashboardEmptyState.tsx
    src/components/dashboard/NBAHeroCard.tsx
    src/components/dashboard/RecentActivityCard.tsx
    src/components/hub/AchievementsTab.tsx
    src/components/hub/HistoryTab.tsx
    src/components/hub/OverviewTab.tsx
    src/components/hub/WelcomeState.tsx
  </files>
  <action>
Migrate 9 component files from react-router-dom to next/navigation. Read each file first to understand exact imports and usage.

**Standard migration pattern for ALL files:**
- `import { useNavigate } from 'react-router-dom'` -> `import { useRouter } from 'next/navigation'`
- `const navigate = useNavigate()` -> `const router = useRouter()`
- `navigate(path)` -> `router.push(path)`
- `navigate(path, { replace: true })` -> `router.replace(path)`
- `import { Link } from 'react-router-dom'` -> `import Link from 'next/link'`
- `<Link to={x}>` -> `<Link href={x}>`
- `import { useLocation } from 'react-router-dom'` -> `import { usePathname } from 'next/navigation'`
- `location.pathname` -> `pathname` (from `usePathname()`)

**Dashboard components (5 files):**
- `CategoryPreviewCard.tsx`: Likely has `useNavigate` or `<Link>` for navigating to study/practice. Replace with `useRouter` / `<Link href=...>`.
- `CompactStatRow.tsx`: May have `<Link>` for drill-down navigation. Replace with next/link.
- `DashboardEmptyState.tsx`: Likely has `<Link>` or `navigate` to onboarding/study routes. Replace accordingly.
- `NBAHeroCard.tsx`: The Next Best Action hero card likely navigates to recommended action. Replace `useNavigate` with `useRouter` and `<Link to>` with `<Link href>`.
- `RecentActivityCard.tsx`: May have navigation to activity details. Replace accordingly.

**Hub components (4 files):**
- `AchievementsTab.tsx`: CRITICAL -- migrate `location.state.focusBadge` to `useSearchParams().get('focusBadge')` from `next/navigation`. This is the badge deep-linking per user decision. Replace any `<Link>` with next/link.
- `HistoryTab.tsx`: Replace `useNavigate` / `<Link>` with next/navigation equivalents.
- `OverviewTab.tsx`: Replace `useNavigate` / `<Link>` with next/navigation equivalents.
- `WelcomeState.tsx`: Replace `useNavigate` / `<Link>` with next/navigation equivalents.

**Audit all Link destinations:** Ensure paths use canonical routes (`/home` not `/dashboard`, `/hub/overview` not `/progress`, etc.). Any old paths found during migration should be updated to canonical equivalents.

Wire into: These components are rendered within pages that were migrated in Plan 03. No additional wiring needed -- they inherit the App Router context from the page.tsx wrappers.
  </action>
  <verify>
    <automated>cd C:/Users/minkk/OneDrive/Documents/GitHub/civic-test-2025 && pnpm typecheck && ! grep -r "from 'react-router-dom'" src/components/dashboard/ src/components/hub/ --include="*.tsx"</automated>
    <manual>Verify AchievementsTab uses useSearchParams for focusBadge, all Links use href not to</manual>
  </verify>
  <done>All 9 dashboard + hub component files migrated. AchievementsTab uses searchParams for badge deep-linking. All Link components use next/link with href. Zero react-router-dom imports in dashboard/ and hub/. Typecheck passes.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate SRS, interview, practice, test, session, social, and onboarding components</name>
  <files>
    src/components/srs/DeckManager.tsx
    src/components/srs/ReviewDeckCard.tsx
    src/components/srs/ReviewSession.tsx
    src/components/srs/SRSWidget.tsx
    src/components/interview/InterviewResults.tsx
    src/components/practice/PracticeResults.tsx
    src/components/test/PreTestScreen.tsx
    src/components/results/TestResultsScreen.tsx
    src/components/sessions/UnfinishedBanner.tsx
    src/components/social/BadgeHighlights.tsx
    src/components/onboarding/OnboardingTour.tsx
  </files>
  <action>
Migrate remaining 11 component files from react-router-dom to next/navigation. Read each file first.

**Same migration patterns as Task 1.**

**SRS components (4 files):**
- `DeckManager.tsx`: Replace `useNavigate` / `<Link>` for navigating to review sessions.
- `ReviewDeckCard.tsx`: Replace `useNavigate` / `<Link>` for card navigation.
- `ReviewSession.tsx`: Replace `useNavigate` for post-review navigation.
- `SRSWidget.tsx`: Replace `useNavigate` / `<Link>` for SRS-related navigation.

**Interview/Practice/Test (3 files):**
- `InterviewResults.tsx`: Replace `useNavigate` / `<Link>` for post-interview navigation. Ensure category null guards are preserved (Sentry fix from v3.0).
- `PracticeResults.tsx`: Replace `useNavigate` / `<Link>` for post-practice navigation.
- `PreTestScreen.tsx`: Replace `useNavigate` / `<Link>` for pre-test setup navigation.

**Results (1 file):**
- `TestResultsScreen.tsx`: Replace `useNavigate` / `<Link>` for post-test navigation.

**Sessions (1 file):**
- `UnfinishedBanner.tsx`: Replace `useNavigate` / `<Link>` for resuming sessions.

**Social (1 file):**
- `BadgeHighlights.tsx`: CRITICAL -- migrate navigation to use search params for badge focus. Replace `navigate('/hub/achievements', { state: { focusBadge: badgeId } })` with `router.push('/hub/achievements?focusBadge=' + badgeId)`. This is the other side of the badge deep-linking (AchievementsTab reads it in Task 1).
  Wire into: `src/components/hub/AchievementsTab.tsx` reads `focusBadge` from search params (migrated in Task 1).

**Onboarding (1 file):**
- `OnboardingTour.tsx`: Replace `useNavigate` / `useLocation` with next/navigation equivalents.

**Audit all Link destinations** as in Task 1. Ensure canonical paths.

After completing both tasks, run a comprehensive grep to verify zero react-router-dom imports remain in src/:
```bash
grep -r "from 'react-router-dom'" src/ --include="*.tsx" --include="*.ts"
```
The ONLY files that should still import react-router-dom are:
- `src/AppShell.tsx` (deleted in Plan 05)
- `src/components/ProtectedRoute.tsx` (deleted in Plan 05)
- `src/components/animations/PageTransition.tsx` (deleted in Plan 05)
  </action>
  <verify>
    <automated>cd C:/Users/minkk/OneDrive/Documents/GitHub/civic-test-2025 && pnpm typecheck && REMAINING=$(grep -rl "from 'react-router-dom'" src/ --include="*.tsx" --include="*.ts" | grep -v AppShell | grep -v ProtectedRoute | grep -v PageTransition | wc -l) && test "$REMAINING" -eq 0 && echo "PASS: Only expected files remain"</automated>
    <manual>Verify BadgeHighlights uses router.push with focusBadge search param, InterviewResults preserves null guards</manual>
  </verify>
  <done>All 11 remaining component files migrated. BadgeHighlights navigates with focusBadge search param. Only AppShell, ProtectedRoute, and PageTransition still import react-router-dom (deleted in Plan 05). Typecheck passes.</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` passes
- Only 3 files still import react-router-dom: AppShell.tsx, ProtectedRoute.tsx, PageTransition.tsx (all deleted in Plan 05)
- Badge deep-linking works via search params (BadgeHighlights writes, AchievementsTab reads)
- All Link components use next/link with href prop
</verification>

<success_criteria>
- 20 component files migrated with zero react-router-dom imports
- Badge deep-linking migrated to search params
- All Link destinations audited for canonical paths
- `pnpm typecheck` passes
</success_criteria>

<output>
After completion, create `.planning/phases/41-route-migration/41-04-SUMMARY.md`
</output>
