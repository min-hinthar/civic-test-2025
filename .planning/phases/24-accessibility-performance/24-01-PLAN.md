---
phase: 24-accessibility-performance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - eslint.config.mjs
  - src/__tests__/setup.ts
  - src/__tests__/a11y/feedbackPanel.a11y.test.tsx
  - src/__tests__/a11y/toast.a11y.test.tsx
  - package.json
autonomous: true

must_haves:
  truths:
    - "ESLint reports jsx-a11y violations on missing alt text, ARIA misuse, and interaction handlers"
    - "vitest-axe toHaveNoViolations() matcher is available in all test files"
    - "At least 2 a11y tests pass using vitest-axe on key interactive components"
  artifacts:
    - path: "eslint.config.mjs"
      provides: "jsx-a11y rules integrated into existing flat config"
      contains: "jsx-a11y"
    - path: "src/__tests__/setup.ts"
      provides: "vitest-axe global matcher registration"
      contains: "vitest-axe"
    - path: "src/__tests__/a11y/feedbackPanel.a11y.test.tsx"
      provides: "Automated a11y test for FeedbackPanel"
      contains: "toHaveNoViolations"
  key_links:
    - from: "eslint.config.mjs"
      to: "eslint-plugin-jsx-a11y"
      via: "plugin import and rule spread"
      pattern: "jsxA11y\\.flatConfigs\\.recommended\\.rules"
---

<objective>
Install and configure accessibility linting (eslint-plugin-jsx-a11y) and accessibility unit testing (vitest-axe), then write initial a11y tests for key interactive components.

Purpose: Establishes automated a11y quality gates so future changes are caught at lint/test time (PERF-03, PERF-04).
Output: Working ESLint a11y rules, vitest-axe setup, and 2+ passing a11y tests.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@eslint.config.mjs
@src/__tests__/setup.ts
@src/components/quiz/FeedbackPanel.tsx
@src/components/BilingualToast.tsx
@.planning/phases/24-accessibility-performance/24-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install a11y dev dependencies and configure ESLint jsx-a11y</name>
  <files>package.json, eslint.config.mjs</files>
  <action>
    1. Install dev dependencies:
       ```bash
       pnpm add -D eslint-plugin-jsx-a11y vitest-axe @next/bundle-analyzer
       ```
       Note: @next/bundle-analyzer installed here for convenience but configured in Plan 07.

    2. Update `eslint.config.mjs` to integrate jsx-a11y:
       - Import: `import jsxA11y from 'eslint-plugin-jsx-a11y';`
       - Add to plugins object: `'jsx-a11y': jsxA11y`
       - Spread rules: `...jsxA11y.flatConfigs.recommended.rules` into the rules object
       - Place AFTER existing rules spread so it adds rules without overriding TS/React config
       - Do NOT use `jsxA11y.flatConfigs.recommended` as a standalone config (conflicts with TS parser per research Pitfall 7)
       - May need to disable specific rules that conflict with project patterns:
         - `'jsx-a11y/no-autofocus': 'off'` if the project uses autoFocus intentionally
         - `'jsx-a11y/click-events-have-key-events': 'off'` if there are div-as-button patterns that are being addressed separately

    3. Run `npx eslint --quiet src/ 2>&1 | head -50` to check for new violations. If there are many, add rule overrides for the most noisy ones that are false positives in this codebase (document reasoning). The goal is zero new errors, not suppress everything.
  </action>
  <verify>
    - `pnpm run lint` passes (or only pre-existing warnings)
    - `npx eslint --print-config src/components/quiz/FeedbackPanel.tsx | grep jsx-a11y` shows rules active
  </verify>
  <done>eslint-plugin-jsx-a11y rules are active in the ESLint config and lint passes</done>
</task>

<task type="auto">
  <name>Task 2: Configure vitest-axe and write initial a11y tests</name>
  <files>src/__tests__/setup.ts, src/__tests__/a11y/feedbackPanel.a11y.test.tsx, src/__tests__/a11y/toast.a11y.test.tsx</files>
  <action>
    1. Add to `src/__tests__/setup.ts`:
       ```typescript
       import 'vitest-axe/extend-expect';
       ```
       This registers the `toHaveNoViolations()` matcher globally.

    2. Create `src/__tests__/a11y/feedbackPanel.a11y.test.tsx`:
       - Import render from @testing-library/react, axe from vitest-axe
       - Test: "FeedbackPanel (correct) has no a11y violations"
         - Render FeedbackPanel with `isCorrect={true}, show={true}, correctAnswer="The Constitution", streakCount={0}, mode="practice", onContinue={vi.fn()}, showBurmese={false}`
         - Run `axe(container)` and assert `toHaveNoViolations()`
       - Test: "FeedbackPanel (incorrect) has no a11y violations"
         - Same but `isCorrect={false}`
       - Mock providers as needed (LanguageContext, TTSContext) -- FeedbackPanel may need them

    3. Create `src/__tests__/a11y/toast.a11y.test.tsx`:
       - Test: "Toast with error type has no a11y violations"
         - Render a Toast-like div with `role="alert"` and content matching current Toast markup
       - Test: "ToastContainer has correct ARIA attributes"
         - Verify `aria-live` and `aria-atomic` are set correctly

    4. Run tests: `pnpm test:run -- src/__tests__/a11y/`
       - If any axe violations are found, they indicate REAL accessibility bugs in the components
       - Fix any critical violations (missing aria-labels, invalid roles) in the component source
       - For minor violations that need broader fixes, add a TODO comment and move on
  </action>
  <verify>
    - `pnpm test:run -- src/__tests__/a11y/` passes with all tests green
    - vitest-axe matcher is available globally (no import needed in individual test files)
  </verify>
  <done>vitest-axe is configured globally, at least 2 a11y tests pass for FeedbackPanel and Toast</done>
</task>

</tasks>

<verification>
- `pnpm run lint` passes
- `pnpm test:run -- src/__tests__/a11y/` passes
- `npx eslint --print-config src/App.tsx 2>/dev/null | grep "jsx-a11y"` shows active rules
</verification>

<success_criteria>
- eslint-plugin-jsx-a11y is installed and active in ESLint flat config
- vitest-axe toHaveNoViolations() matcher works globally
- At least 2 a11y tests pass for FeedbackPanel and Toast components
- No new lint errors introduced (existing warnings acceptable)
</success_criteria>

<output>
After completion, create `.planning/phases/24-accessibility-performance/24-01-SUMMARY.md`
</output>
