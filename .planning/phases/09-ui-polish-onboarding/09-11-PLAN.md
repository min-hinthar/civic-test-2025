---
phase: 09-ui-polish-onboarding
plan: 11
type: execute
wave: 4
depends_on: ["09-01"]
files_modified:
  - src/pages/ProgressPage.tsx
  - src/components/progress/SkillTreePath.tsx
autonomous: true

must_haves:
  truths:
    - "Progress page shows a Duolingo-style vertical skill tree path"
    - "Skill tree has 7 sub-category nodes matching USCIS categories"
    - "Nodes unlock sequentially -- next node unlocks at 50%+ mastery of previous"
    - "Each node has bronze (50%), silver (75%), gold (100%) ring indicators"
    - "Locked nodes are visually dimmed/greyed out"
    - "Active/current node is highlighted and animated"
    - "Skill tree scrolls vertically and looks good on mobile and desktop"
  artifacts:
    - path: "src/components/progress/SkillTreePath.tsx"
      provides: "Vertical skill tree with 7 nodes, sequential unlock, medal rings"
      min_lines: 80
    - path: "src/pages/ProgressPage.tsx"
      provides: "Progress page with embedded skill tree"
      contains: "SkillTreePath"
  key_links:
    - from: "src/components/progress/SkillTreePath.tsx"
      to: "src/lib/mastery/categoryMapping.ts"
      via: "7 sub-category definitions and question counts"
      pattern: "SUB_CATEGORIES|categoryMapping"
    - from: "src/pages/ProgressPage.tsx"
      to: "src/components/progress/SkillTreePath.tsx"
      via: "Renders skill tree with mastery data"
      pattern: "SkillTreePath"
---

<objective>
Create the Duolingo-style vertical skill tree path for the Progress page with 7 sub-category nodes, sequential unlock mechanic, and bronze/silver/gold ring indicators.

Purpose: Visual mastery progression like Duolingo's lesson path gives users a clear sense of journey and accomplishment.
Output: SkillTreePath.tsx component, redesigned ProgressPage.tsx.
</objective>

<execution_context>
@C:\Users\minkk\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\minkk\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-ui-polish-onboarding/09-RESEARCH.md
@.planning/phases/09-ui-polish-onboarding/09-01-SUMMARY.md

@src/pages/ProgressPage.tsx
@src/lib/mastery/categoryMapping.ts
</context>

<instructions>
Use the /frontend-design skill for all UI design and implementation work in this phase. This is a locked user decision.

Key requirements (locked):
- Duolingo-style vertical skill tree path
- 7 sub-category nodes
- Sequential unlock (50%+ mastery)
- Bronze/silver/gold rings
</instructions>

<tasks>

<task type="auto">
  <name>Task 1: Create SkillTreePath Component</name>
  <files>src/components/progress/SkillTreePath.tsx</files>
  <action>
Create `src/components/progress/SkillTreePath.tsx` -- a Duolingo-style vertical skill tree:

**Props:**
```typescript
interface SkillTreePathProps {
  subcategoryMastery: Record<string, number>; // sub-category key -> mastery percentage (0-100)
  onNodeClick?: (subcategoryKey: string) => void;
}
```

**7 Nodes (from categoryMapping.ts SUB_CATEGORIES):**
1. Principles of American Democracy (12 questions) -- blue
2. System of Government (35 questions) -- blue
3. Rights and Responsibilities (10 questions) -- blue
4. Colonial Period and Independence (13 questions) -- amber
5. 1800s (7 questions) -- amber
6. Recent American History (10 questions) -- amber
7. Symbols and Holidays (13 questions) -- emerald

**Vertical Path Layout:**
- Vertical scrolling path with nodes arranged in a slight zigzag pattern (offset left/right alternately)
- Connecting lines between nodes using SVG paths or CSS pseudo-elements
- Path line: dashed for locked sections, solid for unlocked sections
- Path color matches category (blue, amber, emerald segments)

**Node Design:**
- Circular node ~64px diameter
- Category emoji or icon in center (e.g., scales of justice, clock for history, flag for civics)
- Node background gradient matching category color
- Sub-category name + question count as label below/beside node
- Bilingual label (English + Burmese in font-myanmar)

**Ring Indicators (medal system):**
- No ring: 0-49% mastery (unlocked but incomplete)
- Bronze ring: 50-74% mastery -- `ring-4 ring-amber-600/70`
- Silver ring: 75-99% mastery -- `ring-4 ring-gray-400`
- Gold ring: 100% mastery -- `ring-4 ring-yellow-400` with sparkle animation

Implementation: Custom SVG rings around the node circle, or CSS ring utilities with appropriate colors.

**Sequential Unlock:**
- Node 1 is always unlocked
- Node N+1 unlocks when Node N reaches 50%+ mastery
- Locked nodes: `opacity-40 grayscale` filter, no click handler
- Active/current node (first incomplete): pulsing glow animation using motion/react, `animate={{ scale: [1, 1.05, 1] }}` with `repeat: Infinity`
- Unlocked completed nodes: full color with medal ring

**Animations:**
- Entrance: nodes stagger in from bottom using motion/react
- Medal ring transitions on mastery change (if data updates)
- Active node has subtle breathing/pulse animation

**Responsive:**
- Mobile: nodes centered, labels below each node
- Desktop: wider zigzag path, labels alternating left/right of nodes
- Max-width container for readability
  </action>
  <verify>Run `npx tsc --noEmit`. Verify 7 nodes are defined matching SUB_CATEGORIES. Verify unlock logic checks previous node mastery >= 50. Verify medal ring threshold logic (50/75/100).</verify>
  <done>SkillTreePath component with 7 nodes, vertical zigzag path, sequential unlock at 50%, bronze/silver/gold rings, category colors, and bilingual labels.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate Skill Tree into Progress Page</name>
  <files>src/pages/ProgressPage.tsx</files>
  <action>
Redesign ProgressPage to feature the skill tree prominently:

**Page Layout:**
- Bold page title (font-extrabold, text-3xl) with trophy emoji: "Your Learning Journey" / Burmese
- Overall mastery summary at top: percentage with circular progress indicator
- SkillTreePath as the main content area

**Skill Tree Integration:**
- Import SkillTreePath from `@/components/progress/SkillTreePath`
- Compute `subcategoryMastery` from existing mastery hooks/data:
  - Use the mastery calculation utilities from `src/lib/mastery/`
  - Map each sub-category key to its mastery percentage (0-100)
- Pass mastery data to SkillTreePath
- On node click: scroll to or expand the detailed category breakdown (keep existing expandable pattern)

**Keep Existing Features:**
- Category breakdown (expandable sub-categories with question-level detail) -- keep below the skill tree
- Trend chart (recharts) -- keep but style with rounded-2xl card wrapper
- Apply Duolingo visual treatment to existing sections:
  - Rounded-2xl cards
  - Bold section headers
  - 3D chunky buttons for actions (like "Practice Weak Areas")
  - Category color accents

**Empty State:**
- If no mastery data: encouraging message with bilingual text + eagle emoji
- "Start your first test to see your progress!" / Burmese

**Dark Mode:**
- Skill tree path lines and nodes must be visible in dark mode
- Medal rings maintain their color distinction in dark mode
- Category colors stay vibrant
  </action>
  <verify>Run `npx tsc --noEmit`. Verify SkillTreePath is imported and rendered. Verify subcategoryMastery computation connects to mastery data. Verify existing trend chart and category breakdown are preserved.</verify>
  <done>Progress page features prominent skill tree path, mastery summary, and retains existing detailed views with Duolingo visual treatment.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- `npm run lint` passes
- SkillTreePath has 7 nodes
- Sequential unlock logic works (node N+1 locked until node N >= 50%)
- Bronze (50%+), Silver (75%+), Gold (100%) rings are visually distinct
- ProgressPage renders SkillTreePath with mastery data
- Page responsive at 375px, 768px, 1024px+
- Dark mode styling works correctly
</verification>

<success_criteria>
Progress page shows a visually compelling vertical skill tree with category-colored nodes, medal rings for mastery levels, and sequential unlocking. Users see a clear path to completion.
</success_criteria>

<output>
After completion, create `.planning/phases/09-ui-polish-onboarding/09-11-SUMMARY.md`
</output>
