---
phase: 14-unified-navigation
plan: 02
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/components/navigation/Sidebar.tsx
  - src/components/navigation/GlassHeader.tsx
autonomous: true

must_haves:
  truths:
    - "Desktop/tablet users see a left sidebar with 6 nav tabs, 3 utility controls, logo header, and glass-morphism styling"
    - "Sidebar auto-expands on desktop (>=1280px) and auto-collapses to icon-rail on tablet (768-1279px)"
    - "Sidebar hides on scroll-down and shows on scroll-up with spring physics animation"
    - "Collapsed sidebar shows tooltips on hover and expands-first on tablet tap"
    - "Landing and OpEd pages have a minimal glass header with logo"
  artifacts:
    - path: "src/components/navigation/Sidebar.tsx"
      provides: "Desktop/tablet sidebar navigation component"
      min_lines: 150
    - path: "src/components/navigation/GlassHeader.tsx"
      provides: "Minimal glass header for landing/op-ed pages"
      min_lines: 20
  key_links:
    - from: "src/components/navigation/Sidebar.tsx"
      to: "src/components/navigation/NavigationProvider.tsx"
      via: "useNavigation() context hook"
      pattern: "useNavigation\\(\\)"
    - from: "src/components/navigation/Sidebar.tsx"
      to: "src/components/navigation/NavItem.tsx"
      via: "NavItem component renders each tab"
      pattern: "import.*NavItem"
    - from: "src/components/navigation/Sidebar.tsx"
      to: "src/components/navigation/navConfig.ts"
      via: "NAV_TABS array consumption"
      pattern: "import.*NAV_TABS"
---

<objective>
Build the Sidebar component (the primary new navigation surface) and a minimal GlassHeader for public pages. The Sidebar is the biggest new piece of Phase 14 -- a VS Code/Linear-inspired left sidebar with glass-morphism, spring animations, responsive collapse behavior, and full morph animation.

Purpose: Desktop and tablet users get a modern sidebar navigation instead of the current top horizontal bar. Public pages get a branded header.
Output: Sidebar.tsx and GlassHeader.tsx in src/components/navigation/
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-unified-navigation/14-CONTEXT.md
@.planning/phases/14-unified-navigation/14-RESEARCH.md
@.planning/phases/14-unified-navigation/14-01-SUMMARY.md
@src/components/navigation/navConfig.ts
@src/components/navigation/NavItem.tsx
@src/components/navigation/NavBadge.tsx
@src/components/navigation/NavigationProvider.tsx
@src/components/navigation/useMediaTier.ts
@src/styles/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Sidebar component</name>
  <files>src/components/navigation/Sidebar.tsx</files>
  <action>
Create the desktop/tablet sidebar component. This is hidden below md breakpoint (`hidden md:block`).

**Layout structure:**
```
motion.aside (fixed left-0 top-0 bottom-0, z-40, glass-nav class)
  Header (Logo + app name / app icon when collapsed)
  Separator
  Nav items (6 tabs via NAV_TABS)
  Separator
  Utility controls (Language toggle, Theme toggle, Logout)
  Spacer
  Collapse toggle button (chevron)
```

**Dimensions per user decision:**
- Expanded width: 240px
- Collapsed width: 64px (icon-rail)
- Animate width with motion/react spring: `{ type: 'spring', stiffness: 300, damping: 24 }`

**motion.aside props:**
- `animate={{ width: isExpanded ? 240 : 64, x: navVisible ? 0 : -240 }}`
  - Width animation: expand/collapse morph
  - x animation: scroll-hide (slides off-screen left when scrolling down)
- `transition={{ type: 'spring', stiffness: 300, damping: 24 }}`
- className: `glass-nav fixed left-0 top-0 bottom-0 z-40 hidden md:flex flex-col overflow-hidden`
- `ref`: attach to sidebarRef for click-outside detection

**Header section:**
- Expanded: Logo icon (use a simple `<span>` with app icon or text "CTP") + "Civic Test Prep" text, font-extrabold
- Collapsed: Logo icon only, centered
- Full morph animation per user decision: logo text fades in/out with AnimatePresence, icon transitions smoothly
- Padding: px-4 py-4

**Nav items section:**
- Map over `NAV_TABS` and render `<NavItem>` for each with:
  - variant: `isExpanded ? 'sidebar-expanded' : 'sidebar-collapsed'`
  - isActive: compare current pathname with tab.href (use `useLocation()`)
  - isLocked: from NavigationProvider
  - showBurmese: from `useLanguage()` context
  - badges: from NavigationProvider
  - onLockedTap: show shake animation + toast ("Complete or exit the test first")
- Gap between items: gap-1 (items have internal gap-3 padding per user decision for spacious feel)

**Utility controls section:**
- Separator: thin horizontal line (`h-px bg-border/40 mx-3`)
- Language toggle button: Languages icon + label. On click: call `toggleMode()` from LanguageContext. Show "Myanmar" or "English" label when expanded (inverted -- shows what it switches TO).
- Theme toggle button: Sun/Moon icon + label. On click: call `toggleTheme()` from ThemeContext.
- Logout button: LogOut icon + label in destructive color. On click: `logout().then(() => navigate('/'))`. Only show when user is authenticated.
- Style utility controls same as nav items but without active state or badges.

**Collapse toggle button:**
- Position: bottom of sidebar, `mt-auto`
- Icon: ChevronLeft when expanded, ChevronRight when collapsed
- On click: `toggleSidebar()` from NavigationProvider
- Tooltip when collapsed: "Expand sidebar"

**Tablet tap behavior per user decision:**
- When tier is 'tablet' and sidebar is collapsed, tapping a nav item should EXPAND the sidebar first (not navigate). User taps again to navigate.
- Implementation: in the NavItem onClick handler, if tier is 'tablet' and !isExpanded, call setExpanded(true) and return (don't navigate).

**Lock behavior per user decision:**
- When isLocked: all nav items get grayed out/unclickable except the current active route
- Show warning indicator at top of sidebar (small banner or icon)
- Tapping locked item: shake animation (x: [0, -6, 6, -4, 4, 0] over 0.4s) + toast message

**Dark mode per user decision:**
- glass-nav class already handles dark mode border glow (1px white/10-20% opacity)
- No additional dark mode handling needed in the component

**Tooltips for collapsed state per user decision:**
- Use CSS-based tooltips via `data-tooltip` attribute + `::after` pseudo-element
- Position tooltip to the right of the icon with a small arrow
- Only show on hover when collapsed
- Add the CSS for `[data-tooltip]` in the component or in globals.css

Import from: NavigationProvider (useNavigation), navConfig (NAV_TABS), NavItem, useLanguage, useThemeContext, useAuth, useLocation, useNavigate, useToast, motion/react, lucide-react (Languages, Sun, Moon, LogOut, ChevronLeft, ChevronRight).
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm type-checking passes. Run `npx eslint src/components/navigation/Sidebar.tsx --max-warnings 0`.
  </verify>
  <done>
Sidebar.tsx renders a fixed left sidebar with: glass-morphism styling, 6 nav tabs from navConfig, 3 utility controls (language/theme/logout), spring-animated expand/collapse (240px/64px), scroll-hide via spring x translation, logo morph animation, collapsed tooltips, tablet expand-first behavior, lock warning with shake animation, and proper z-40 layering. Hidden below md breakpoint.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create GlassHeader for public pages</name>
  <files>src/components/navigation/GlassHeader.tsx</files>
  <action>
Create a minimal glass header for the landing page and op-ed page per user decision.

**Props:** `{ showSignIn?: boolean; showBack?: boolean; backHref?: string }`

**Layout:**
- Fixed or sticky top-0, full width, z-30
- Glass-morphism: `glass-nav` class (reuse from globals.css)
- Height: ~56px
- Flex row: Logo on left, action button on right
- Max-width container centered (max-w-7xl mx-auto px-4)

**Logo:** "Civic Test Prep" text, font-extrabold, text-foreground. Link to `/`.

**Sign In button (for landing page):**
- When `showSignIn` is true: render a Link to `/auth` with text "Sign In", styled as a subtle button (bg-primary/10 hover:bg-primary/20 text-primary rounded-xl px-4 py-2 text-sm font-bold).

**Back button (for op-ed page):**
- When `showBack` is true: render a Link to `backHref ?? '/'` with ArrowLeft icon + "Back" text.

**No nav items** -- this is a minimal branding header, not a full nav bar.

Import from: Link (react-router-dom), ArrowLeft (lucide-react).
  </action>
  <verify>
Run `npx tsc --noEmit` and `npx eslint src/components/navigation/GlassHeader.tsx --max-warnings 0`.
  </verify>
  <done>
GlassHeader renders a minimal glass-morphism header with logo and optional Sign In or Back button. Ready to replace AppNavigation on LandingPage and OpEdPage.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- `npx eslint src/components/navigation/Sidebar.tsx src/components/navigation/GlassHeader.tsx --max-warnings 0` passes
- Sidebar imports and uses NavigationProvider context, NavItem, navConfig
- Sidebar has `hidden md:flex` class (not visible on mobile)
- GlassHeader uses glass-nav CSS class
</verification>

<success_criteria>
Sidebar component is complete with all locked decision requirements (glass-morphism, spring animations, collapse/expand, tooltips, lock behavior, tablet expand-first). GlassHeader is ready for landing/op-ed pages. Both compile and lint cleanly.
</success_criteria>

<output>
After completion, create `.planning/phases/14-unified-navigation/14-02-SUMMARY.md`
</output>
