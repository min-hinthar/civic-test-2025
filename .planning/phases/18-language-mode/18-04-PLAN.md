---
phase: 18-language-mode
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/BilingualToast.tsx
  - src/components/test/PreTestScreen.tsx
  - src/components/interview/InterviewSetup.tsx
autonomous: true

must_haves:
  truths:
    - "BilingualToast hides Burmese text when in English-only mode"
    - "PreTestScreen hides all unconditional Burmese text when in English-only mode"
    - "PreTestScreen shows USCIS simulation message when in English-only mode"
    - "InterviewSetup shows USCIS simulation message when in English-only mode"
    - "USCIS simulation message says questions are in English only"
    - "USCIS message is bilingual in Myanmar mode"
    - "InterviewSetup 'First time?' empty state hides Burmese when in English-only mode"
  artifacts:
    - path: "src/components/BilingualToast.tsx"
      provides: "Language-mode-aware toast that hides Burmese in English mode"
    - path: "src/components/test/PreTestScreen.tsx"
      provides: "Pre-test screen with showBurmese guards and USCIS simulation message"
    - path: "src/components/interview/InterviewSetup.tsx"
      provides: "Interview setup with USCIS simulation message"
  key_links:
    - from: "src/components/BilingualToast.tsx"
      to: "src/contexts/LanguageContext.tsx"
      via: "useLanguage() hook"
      pattern: "useLanguage"
---

<objective>
Fix BilingualToast to respect language mode, add showBurmese guards to unconditional Burmese text in PreTestScreen, and add USCIS simulation messages to both PreTestScreen and InterviewSetup.

Purpose: English-only mode must show zero Burmese text in toasts and pre-screens. The USCIS simulation message reinforces the test-feel for English-only users.

Output: Updated BilingualToast.tsx, PreTestScreen.tsx, InterviewSetup.tsx
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@src/components/BilingualToast.tsx
@src/components/test/PreTestScreen.tsx
@src/components/interview/InterviewSetup.tsx
@src/contexts/LanguageContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix BilingualToast to respect language mode</name>
  <files>src/components/BilingualToast.tsx</files>
  <action>
The Toast component (inner component at line ~182) always renders Burmese text at line 231:
```tsx
<p className="font-myanmar mt-1 text-sm leading-snug opacity-90">{toast.message.my}</p>
```

Fix:
1. **Import useLanguage** in the Toast component: `import { useLanguage } from '@/contexts/LanguageContext';`

2. **In the Toast component** (the function around line 182), add `const { showBurmese } = useLanguage();` at the top of the function body.

3. **Wrap the Burmese line** with a showBurmese guard:
```tsx
{showBurmese && (
  <p className="font-myanmar mt-1 text-sm leading-snug opacity-90">{toast.message.my}</p>
)}
```

4. **Keep the BilingualMessage type** -- data always carries both languages. Only rendering is gated.

IMPORTANT: The `useLanguage` call must be inside a component rendered within `LanguageProvider`. The Toast component is rendered inside `ToastProvider` which is a sibling/child of `LanguageProvider` in the app tree. Verify this is the case by checking `_app.tsx` provider order. If LanguageProvider wraps ToastProvider, this works. If not, handle gracefully with a try-catch or optional context.
  </action>
  <verify>
- `npx tsc --noEmit` passes
- The Burmese text line in Toast is wrapped with `{showBurmese && ...}`
- `useLanguage` is imported and called
  </verify>
  <done>BilingualToast respects language mode -- Burmese text hidden in English-only mode.</done>
</task>

<task type="auto">
  <name>Task 2: Fix PreTestScreen unconditional Burmese + add USCIS simulation message</name>
  <files>src/components/test/PreTestScreen.tsx</files>
  <action>
PreTestScreen has several unconditional Burmese text renders that must be gated with `showBurmese`. The component already has `const { showBurmese } = useLanguage();`.

**Fix unconditional Burmese (4 locations):**

1. **Line ~90-92** (encouraging message Burmese): Wrap with showBurmese guard:
```tsx
// BEFORE:
<span className="block font-myanmar mt-1">
  အသက်ရှုနက်နက်ရှူပါ။ ဤလေ့ကျင့်ခန်းက သင့်နိုင်ငံသားဖြစ်ခြင်းခရီးအတွက် အကူအညီဖြစ်ပါလိမ့်မယ်။
</span>

// AFTER:
{showBurmese && (
  <span className="block font-myanmar mt-1">
    အသက်ရှုနက်နက်ရှူပါ။ ဤလေ့ကျင့်ခန်းက သင့်နိုင်ငံသားဖြစ်ခြင်းခရီးအတွက် အကူအညီဖြစ်ပါလိမ့်မယ်။
  </span>
)}
```

2. **Line ~99** (test info "Questions / မေးခွန်းများ"): Make bilingual:
```tsx
// BEFORE:
<span>Questions / မေးခွန်းများ</span>

// AFTER:
<span>{showBurmese ? 'Questions / မေးခွန်းများ' : 'Questions'}</span>
```

3. **Line ~103** (test info "Minutes / မိနစ်"): Same pattern:
```tsx
<span>{showBurmese ? 'Minutes / မိနစ်' : 'Minutes'}</span>
```

4. **Line ~118** (pass threshold Burmese): Wrap with showBurmese guard:
```tsx
// BEFORE:
<span className="block font-myanmar">{strings.test.passThreshold.my}</span>

// AFTER:
{showBurmese && (
  <span className="block font-myanmar">{strings.test.passThreshold.my}</span>
)}
```

**Add USCIS simulation message** (shown when in English-only mode, per user decision "shown every time before mock test"):

Add between the BilingualHeading and the encouraging message (around line 84):
```tsx
{/* USCIS simulation message */}
<div className="mb-4 max-w-md rounded-xl border border-primary/30 bg-primary-subtle/20 px-4 py-3">
  <p className="text-sm font-medium text-foreground">
    This simulates the real USCIS civics test — questions are in English only.
  </p>
  {showBurmese && (
    <p className="font-myanmar text-xs text-muted-foreground mt-1">
      ဤလေ့ကျင့်ခန်းသည် တကယ့် USCIS နိုင်ငံသားစာမေးပွဲကို တူညီစေပါသည် — မေးခွန်းများသည် အင်္ဂလိပ်ဘာသာဖြင့်သာ ဖြစ်ပါသည်။
    </p>
  )}
</div>
```

Note: Per user decision, USCIS message is shown EVERY TIME before mock test (not just in English mode). The message itself is bilingual in Myanmar mode (English + Burmese translation), English-only in English mode. The message content is always about English-only questions.
  </action>
  <verify>
- `npx tsc --noEmit` passes
- No unconditional `font-myanmar` text renders without `showBurmese` guard
- USCIS simulation message div exists in the component
- Grep `font-myanmar` in PreTestScreen.tsx and verify all are inside `showBurmese &&` blocks
  </verify>
  <done>PreTestScreen has all Burmese text gated with showBurmese. USCIS simulation message added.</done>
</task>

<task type="auto">
  <name>Task 3: Add USCIS simulation message to InterviewSetup</name>
  <files>src/components/interview/InterviewSetup.tsx</files>
  <action>
**Add USCIS simulation message** to InterviewSetup, shown every time before interview (per user decision).

1. Add the USCIS message between the interviewer avatar and the mode selection cards (around line 147, before the `<div className="mb-6 grid ...">` block):

```tsx
{/* USCIS simulation message */}
<div className="mb-6 mx-auto max-w-md rounded-xl border border-primary/30 bg-primary-subtle/20 px-4 py-3">
  <p className="text-sm font-medium text-foreground text-center">
    This simulates the real USCIS civics test — questions are in English only.
  </p>
  {showBurmese && (
    <p className="font-myanmar text-xs text-muted-foreground mt-1 text-center">
      ဤလေ့ကျင့်ခန်းသည် တကယ့် USCIS နိုင်ငံသားစာမေးပွဲကို တူညီစေပါသည် — မေးခွန်းများသည် အင်္ဂလိပ်ဘာသာဖြင့်သာ ဖြစ်ပါသည်။
    </p>
  )}
</div>
```

2. **Fix unconditional Burmese in "First time?" empty state** (line ~316-318):
```tsx
// BEFORE:
<p className="mt-1 font-myanmar text-xs text-muted-foreground">
  {'ပထမဆုံးအကြိမ်လား? စမ်းကြည့်ပါ!'}
</p>

// AFTER:
{showBurmese && (
  <p className="mt-1 font-myanmar text-xs text-muted-foreground">
    ပထမဆုံးအကြိမ်လား? စမ်းကြည့်ပါ!
  </p>
)}
```

3. **Add "Answer in English" guidance in Myanmar mode**: Per user decision, include Burmese guidance hint "Answer in English" near the mode description area. Add a subtle bilingual note below the mode cards:
```tsx
{showBurmese && (
  <div className="mb-4 text-center">
    <p className="font-myanmar text-xs text-muted-foreground">
      အင်တာဗျူးတွင် အင်္ဂလိပ်ဘာသာဖြင့် ဖြေဆိုပါ
    </p>
    <p className="text-xs text-muted-foreground mt-0.5">
      (Answer questions in English)
    </p>
  </div>
)}
```
Place this after the mode cards div and before the mic permission notice.
  </action>
  <verify>
- `npx tsc --noEmit` passes
- USCIS simulation message div exists in InterviewSetup
- "First time?" Burmese text is gated with showBurmese
- "Answer in English" guidance appears in Myanmar mode
  </verify>
  <done>InterviewSetup has USCIS simulation message, fixed unconditional Burmese, and "Answer in English" guidance.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- `npm run lint` passes
- Toasts show English-only in English mode, bilingual in Myanmar mode
- PreTestScreen has zero unconditional Burmese renders
- Both PreTestScreen and InterviewSetup show USCIS simulation message
</verification>

<success_criteria>
- BilingualToast hides Burmese text in English-only mode
- PreTestScreen has all 4 unconditional Burmese locations fixed
- USCIS simulation message appears on both pre-test and interview setup screens
- InterviewSetup has "Answer in English" guidance in Myanmar mode
- No TypeScript or ESLint errors
</success_criteria>

<output>
After completion, create `.planning/phases/18-language-mode/18-04-SUMMARY.md`
</output>
