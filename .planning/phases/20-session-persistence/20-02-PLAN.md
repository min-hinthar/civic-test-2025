---
phase: 20-session-persistence
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/sessions/SessionCountdown.tsx
autonomous: true

must_haves:
  truths:
    - "User sees a full-screen 5-4-3-2-1-Go! countdown before timed sessions"
    - "Each number shows with a scale animation and circular progress ring depleting per second"
    - "Tick sound plays on every number (5-1), different Go chime plays on Go"
    - "Skip button appears after 1.5s delay and allows bypassing countdown via tap or Space/Enter"
    - "Reduced motion shows just numbers without scale/ring animation"
    - "Context subtitle shows session info beneath the number"
  artifacts:
    - path: "src/components/sessions/SessionCountdown.tsx"
      provides: "Full-screen countdown overlay with circular ring, sounds, skip, bilingual Go"
      exports: ["SessionCountdown"]
  key_links:
    - from: "src/components/sessions/SessionCountdown.tsx"
      to: "src/lib/audio/soundEffects.ts"
      via: "imports playCountdownTick, playCountdownGo"
      pattern: "import.*playCountdown"
    - from: "src/components/sessions/SessionCountdown.tsx"
      to: "motion/react"
      via: "motion.circle for ring animation, AnimatePresence for number transitions"
      pattern: "motion\\.circle"
---

<objective>
Build the full-screen SessionCountdown overlay component with circular progress ring, tick sounds, skip button, and bilingual Go message.

Purpose: This countdown shows before every timed mock test (new or resumed) per user decision. It creates a dramatic "game starting" feel with energy and impact.

Output: A single self-contained component at `src/components/sessions/SessionCountdown.tsx`.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/20-session-persistence/20-RESEARCH.md
@.planning/phases/20-session-persistence/20-CONTEXT.md
@src/components/interview/InterviewCountdown.tsx
@src/lib/motion-config.ts
@src/hooks/useReducedMotion.ts
@src/lib/audio/soundEffects.ts
@src/contexts/LanguageContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: SessionCountdown overlay component</name>
  <files>src/components/sessions/SessionCountdown.tsx</files>
  <action>
Create `src/components/sessions/SessionCountdown.tsx`:

**Props interface:**
```typescript
interface SessionCountdownProps {
  /** Called when countdown completes (after "Go!" displays) */
  onComplete: () => void;
  /** Subtitle text shown beneath the number (e.g., "Mock Test — 10 Questions") */
  subtitle?: string;
}
```

**Component structure:**

1. **State:**
   - `step`: starts at 5, decrements to 0 (0 = "Go!"), then completes
   - `showSkip`: false initially, becomes true after 1.5s delay
   - Use `useState` for both (not useRef, per React Compiler rules)

2. **Timer logic:**
   - Use `useEffect` that runs on each `step` change
   - Each number step (5, 4, 3, 2, 1) lasts exactly 1000ms
   - "Go!" step (0) lasts 500ms before calling `onComplete`
   - On each step transition, play the appropriate sound:
     - Steps 5-1: call `playCountdownTick()` (from soundEffects.ts -- plan 01 adds these, but import them; if they don't exist yet at execution time, the import will resolve when plan 01 completes)
     - Step 0 (Go!): call `playCountdownGo()`
   - NOTE: Sound functions may not exist yet when this plan executes (plan 01 adds them in Wave 1 parallel). Add the imports but wrap in try/catch so the component compiles even if the functions aren't exported yet. Alternatively, since both plans are Wave 1, the executor should handle this gracefully -- just import normally and trust the build will work after both plans complete.

3. **Skip button:**
   - Appears after 1.5s via `useEffect` with `setTimeout(setShowSkip(true), 1500)`
   - Text: "Tap to start" (bilingual: follows language mode)
   - Clicking it OR pressing Space/Enter immediately calls `onComplete`
   - Use `onKeyDown` handler on the button element for Space/Enter
   - Auto-focus the skip button when it appears using a ref + `useEffect`

4. **Circular progress ring (SVG):**
   - SVG viewBox `0 0 120 120`, radius 54, center at (60, 60)
   - Background ring: `stroke="hsl(var(--border))"`, strokeWidth 6, no fill
   - Progress ring: `stroke="hsl(var(--accent))"` (orange/accent, NOT primary blue per user decision), strokeWidth 6, strokeLinecap round
   - Use `motion.circle` for animated `strokeDashoffset`
   - Circumference = `2 * Math.PI * 54`
   - Progress depletes from full to empty within each 1-second step
   - Animate `strokeDashoffset` from 0 to CIRCUMFERENCE over 1 second per step
   - Use `transform="rotate(-90 60 60)"` so ring starts from top
   - Reduced motion: hide the ring entirely (just show numbers)

5. **Number display:**
   - Centered inside the SVG ring area
   - Extra large, bold: `text-8xl sm:text-9xl font-black` for numbers, `text-5xl sm:text-6xl font-black` for "Go!"
   - Color: `text-foreground` for numbers (maximum readability), `text-accent` for "Go!"
   - "Go!" is bilingual: English mode shows "Go!", Myanmar mode shows "စတင်!" (per language mode)
   - Use `AnimatePresence mode="wait"` with spring scale animation:
     - `initial={{ opacity: 0, scale: 2.5 }}`
     - `animate={{ opacity: 1, scale: 1 }}`
     - `exit={{ opacity: 0, scale: 0.5 }}`
     - Spring: `type: 'spring', stiffness: 400, damping: 17`
   - Reduced motion: just opacity fade, no scale

6. **Subtitle:**
   - Below the ring/number area
   - `text-sm text-muted-foreground font-medium`
   - Shows the `subtitle` prop text (e.g., "Mock Test — Q8/20" or "Mock Test — 10 Questions")

7. **Overlay background:**
   - `fixed inset-0 z-50` -- full screen
   - `bg-background/95 backdrop-blur-md` (blurred backdrop per discretion recommendation)
   - `flex flex-col items-center justify-center`

8. **Reduced motion:**
   - Use `useReducedMotion()` hook
   - When true: no scale animation (just opacity), no ring animation, still show numbers and play sounds

Import `useLanguage` from `@/contexts/LanguageContext` for bilingual "Go!" text.
Import `useReducedMotion` from `@/hooks/useReducedMotion`.
Import `playCountdownTick`, `playCountdownGo` from `@/lib/audio/soundEffects`.
Import `motion`, `AnimatePresence` from `motion/react`.
  </action>
  <verify>
`npm run typecheck` passes. `npm run lint` passes. Component renders without errors in dev mode. The countdown cycles through 5-4-3-2-1-Go! with appropriate timing. Skip button appears after delay and works with click and keyboard.
  </verify>
  <done>
SessionCountdown component renders full-screen overlay with 5-4-3-2-1-Go! sequence, circular SVG ring, tick/go sounds, skip button after 1.5s, bilingual Go text, reduced motion support, and subtitle display. Component is fully self-contained and ready for integration into TestPage and PracticePage.
  </done>
</task>

</tasks>

<verification>
1. `npm run typecheck` passes
2. `npm run lint` passes
3. Component accepts `onComplete` and `subtitle` props
4. Number sequence is 5-4-3-2-1-Go! with 1s per number, 0.5s for Go
5. SVG ring animates (depletes) each second
6. Skip button appears after 1.5s, responds to click and Space/Enter
7. Sounds play on each step (tick for numbers, chime for Go)
8. Reduced motion shows numbers without scale/ring animation
9. Bilingual Go text follows language mode
</verification>

<success_criteria>
- SessionCountdown.tsx compiles and exports correctly
- Full countdown sequence completes in ~5.5 seconds
- Skip button can bypass the countdown at any point
- Component is fully accessible (keyboard, reduced motion)
- "Go!" message is bilingual per language mode setting
</success_criteria>

<output>
After completion, create `.planning/phases/20-session-persistence/20-02-SUMMARY.md`
</output>
