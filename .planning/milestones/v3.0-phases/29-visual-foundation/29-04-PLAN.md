---
phase: 29-visual-foundation
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/TestPage.tsx
  - src/pages/OpEdPage.tsx
  - src/components/practice/PracticeSession.tsx
  - src/components/results/TestResultsScreen.tsx
  - src/components/quiz/SkippedReviewPhase.tsx
  - src/styles/globals.css
autonomous: true
requirements:
  - VISC-05

must_haves:
  truths:
    - "No component uses the legacy .glass-panel class"
    - "All migrated components use one of the three-tier glass classes (glass-light, glass-medium, glass-heavy)"
    - "Hover lift effects are preserved on all migrated components"
    - "Dark mode glass surfaces have readable text with proper contrast"
    - "The .glass-panel class definition is removed from globals.css"
  artifacts:
    - path: "src/pages/TestPage.tsx"
      provides: "Glass panel migrated to glass-light"
    - path: "src/pages/OpEdPage.tsx"
      provides: "Glass panel migrated to glass-medium"
    - path: "src/components/practice/PracticeSession.tsx"
      provides: "Glass panel migrated to glass-light"
    - path: "src/components/results/TestResultsScreen.tsx"
      provides: "Glass panel migrated to glass-light"
    - path: "src/components/quiz/SkippedReviewPhase.tsx"
      provides: "Glass panel migrated to glass-light"
    - path: "src/styles/globals.css"
      provides: "Legacy .glass-panel class removed"
  key_links:
    - from: "src/styles/globals.css"
      to: "tokens.css"
      via: "glass tiers reference CSS custom properties"
      pattern: "glass-light-opacity|glass-medium-opacity"
---

<objective>
Migrate legacy .glass-panel usages to the three-tier glass system and remove the legacy class.

Purpose: The three-tier glassmorphism system (.glass-light, .glass-medium, .glass-heavy) is dark-mode-aware with proper contrast, blur, and shadow depth. The legacy .glass-panel class doesn't participate in this system (VISC-05). Migrating ensures consistent dark mode glass contrast across all surfaces.
Output: 5 components migrated, .glass-panel class removed from globals.css.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/styles/globals.css
@src/pages/TestPage.tsx
@src/pages/OpEdPage.tsx
@src/components/practice/PracticeSession.tsx
@src/components/results/TestResultsScreen.tsx
@src/components/quiz/SkippedReviewPhase.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate glass-panel usages to three-tier classes</name>
  <files>src/pages/TestPage.tsx, src/pages/OpEdPage.tsx, src/components/practice/PracticeSession.tsx, src/components/results/TestResultsScreen.tsx, src/components/quiz/SkippedReviewPhase.tsx</files>
  <action>
Replace each `glass-panel` className with the appropriate tier class plus explicit hover/transition effects that were bundled in the legacy class.

**The legacy .glass-panel includes these behaviors** (from globals.css):
- `rounded-3xl border border-border/70 bg-card/90 shadow-2xl shadow-primary/10 backdrop-blur-xl`
- `transition duration-500 hover:-translate-y-1 hover:shadow-primary/30`
- `focus-within:ring-2 focus-within:ring-primary/40`
- `dark:border-border dark:bg-background/80`

**Migration mapping:**

1. **TestPage.tsx** (2 usages): Replace `glass-panel` with `glass-light`. Each usage currently has `glass-panel rounded-2xl p-6 shadow-2xl shadow-primary/20`. Change to:
   ```
   glass-light p-6 shadow-2xl shadow-primary/20 transition duration-500 hover:-translate-y-1 hover:shadow-primary/30 focus-within:ring-2 focus-within:ring-primary/40
   ```
   Note: Remove `rounded-2xl` because `.glass-light` already includes `border-radius: var(--radius-2xl)`. Keep `p-6` and `shadow-2xl shadow-primary/20`.

2. **PracticeSession.tsx** (1 usage): Same pattern as TestPage. Replace `glass-panel rounded-2xl p-6 shadow-2xl shadow-primary/20` with:
   ```
   glass-light p-6 shadow-2xl shadow-primary/20 transition duration-500 hover:-translate-y-1 hover:shadow-primary/30 focus-within:ring-2 focus-within:ring-primary/40
   ```

3. **TestResultsScreen.tsx** (1 usage): Same pattern. Replace identically.

4. **SkippedReviewPhase.tsx** (1 usage): Same pattern. Replace identically.

5. **OpEdPage.tsx** (1 usage): This is a header with a gradient overlay, more prominent. Replace `glass-panel` with `glass-medium`. This usage has more complex styling -- preserve all the existing classes around it, just swap `glass-panel` for `glass-medium` and add the transition/hover classes:
   ```
   glass-medium ... transition duration-500 hover:-translate-y-1 hover:shadow-primary/30
   ```
   Keep all other existing classes (`relative overflow-hidden`, gradient, etc.) as-is.

IMPORTANT: The `.glass-light` class already provides `border-radius: var(--radius-2xl)` (which equals `rounded-2xl`). Remove any explicit `rounded-2xl` or `rounded-3xl` that becomes redundant. If a component needs a different radius, add it explicitly after the glass class.
  </action>
  <verify>
Run `npm run build` -- must succeed.
Run `grep -r "glass-panel" src/ --include="*.tsx" --include="*.ts"` -- should return 0 matches.
Run `grep -r "glass-light\|glass-medium" src/pages/TestPage.tsx src/pages/OpEdPage.tsx src/components/practice/PracticeSession.tsx src/components/results/TestResultsScreen.tsx src/components/quiz/SkippedReviewPhase.tsx` -- should return 6 matches (5 glass-light + 1 glass-medium).
  </verify>
  <done>All 6 glass-panel usages across 5 files are migrated to the appropriate three-tier glass class with hover effects preserved.</done>
</task>

<task type="auto">
  <name>Task 2: Remove legacy .glass-panel class from globals.css</name>
  <files>src/styles/globals.css</files>
  <action>
After confirming no remaining glass-panel usages in the codebase, remove the `.glass-panel` class definition from `globals.css`.

The definition to remove (around line 335-337):
```css
.glass-panel {
  @apply rounded-3xl border border-border/70 bg-card/90 shadow-2xl shadow-primary/10 backdrop-blur-xl transition duration-500 hover:-translate-y-1 hover:shadow-primary/30 focus-within:ring-2 focus-within:ring-primary/40 dark:border-border dark:bg-background/80;
}
```

Do NOT remove `.glass-card`, `.glass-light`, `.glass-medium`, `.glass-heavy`, `.stat-card`, `.glass-nav`, or any other glass-related classes. Only remove `.glass-panel`.
  </action>
  <verify>
Run `npm run build` -- must succeed.
Run `npm run lint:css` -- must pass.
Run `grep "glass-panel" src/styles/globals.css` -- should return 0 matches.
Run `grep "glass-light" src/styles/globals.css` -- should return matches (confirming three-tier system is intact).
  </verify>
  <done>The legacy .glass-panel class is removed from globals.css. The three-tier glass system (.glass-light/medium/heavy) remains intact.</done>
</task>

</tasks>

<verification>
- `npm run build` passes
- `npm run lint:css` passes
- Zero `glass-panel` references in src/ directory
- All 5 migrated components render glass surfaces with hover lift and dark mode contrast
- Three-tier glass classes intact in globals.css
</verification>

<success_criteria>
All legacy .glass-panel usages are migrated to the three-tier glass system. Dark mode glass surfaces use proper contrast-tuned opacity and purple tint. Hover lift effects are preserved. The legacy class is removed.
</success_criteria>

<output>
After completion, create `.planning/phases/29-visual-foundation/29-04-SUMMARY.md`
</output>
