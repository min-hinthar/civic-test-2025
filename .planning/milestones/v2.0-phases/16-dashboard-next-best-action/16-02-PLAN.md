---
phase: 16-dashboard-next-best-action
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/dashboard/CompactStatRow.tsx
  - src/components/dashboard/CategoryPreviewCard.tsx
  - src/components/dashboard/RecentActivityCard.tsx
autonomous: true

must_haves:
  truths:
    - "User sees 4 compact stat glass cards showing streak, mastery %, SRS due count, and questions practiced"
    - "Stat numbers animate from 0 to current value on mount using react-countup"
    - "SRS due count uses urgency color coding (green 0-2, amber 3-5, red 6+)"
    - "Stat cards are bilingual with English primary and Burmese below"
    - "Tapping each stat card navigates to the relevant page"
    - "User sees category preview card showing top 3 weakest categories"
    - "User sees recent activity card showing last 2-3 mock test sessions"
    - "Both preview cards are tappable to navigate to Hub tabs"
  artifacts:
    - path: "src/components/dashboard/CompactStatRow.tsx"
      provides: "4-stat glass card grid with count-up animation"
      contains: "CompactStatRow"
    - path: "src/components/dashboard/CategoryPreviewCard.tsx"
      provides: "Top 3 weak categories mini preview"
      contains: "CategoryPreviewCard"
    - path: "src/components/dashboard/RecentActivityCard.tsx"
      provides: "Last 2-3 study sessions preview"
      contains: "RecentActivityCard"
  key_links:
    - from: "src/components/dashboard/CompactStatRow.tsx"
      to: "react-countup"
      via: "CountUp component import"
      pattern: "import.*CountUp.*react-countup"
    - from: "src/components/dashboard/CompactStatRow.tsx"
      to: "src/components/hub/GlassCard.tsx"
      via: "GlassCard wrapper"
      pattern: "import.*GlassCard"
    - from: "src/components/dashboard/CategoryPreviewCard.tsx"
      to: "/hub/overview"
      via: "tappable navigation to Hub Overview"
      pattern: "/hub/overview"
---

<objective>
Create the CompactStatRow, CategoryPreviewCard, and RecentActivityCard components for the new dashboard layout.

Purpose: These are the supporting UI components below the NBA hero card. The stat row gives a quick numeric snapshot, while preview cards provide compact entry points to the Progress Hub. All use the GlassCard design system for visual consistency.

Output: Three new dashboard components ready for composition in Dashboard.tsx.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/16-dashboard-next-best-action/16-RESEARCH.md
@src/components/hub/StatCard.tsx (existing stat card pattern to adapt)
@src/components/hub/GlassCard.tsx (glass card wrapper)
@src/components/celebrations/CountUpScore.tsx (count-up animation pattern)
@src/hooks/useReducedMotion.ts (reduced motion support)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CompactStatRow with count-up animations</name>
  <files>src/components/dashboard/CompactStatRow.tsx</files>
  <action>
Create `src/components/dashboard/CompactStatRow.tsx`:

**Props interface:**
```typescript
interface CompactStatRowProps {
  streak: number;
  mastery: number;           // 0-100
  srsDue: number;
  practiced: number;
  totalQuestions: number;
  isLoading: boolean;
}
```

**Implementation:**
1. Grid layout: `grid grid-cols-2 gap-3 sm:grid-cols-4` (matching OverviewTab pattern)

2. Each stat is a tappable GlassCard with:
   - Lucide icon at top (Flame for streak, TrendingUp for mastery, BookOpen for SRS due, CheckCircle for practiced)
   - Bold number using `react-countup` CountUp component (respects reduced motion -- show static number when `shouldReduceMotion`)
   - Bilingual label below (English + Burmese per stat)
   - `onClick` handler navigating to relevant page

3. Stat definitions:
   - **Streak**: icon Flame, value `streak`, navigate `/hub/achievements`, label "Streak" / "ဆက်တိုက်ရက်"
   - **Mastery**: icon TrendingUp, value `mastery` + "%" suffix, navigate `/hub/overview`, label "Mastery" / "ကျွမ်းကျင်မှု"
   - **SRS Due**: icon BookOpen, value `srsDue`, navigate `/study#review`, label "SRS Due" / "SRS ပြန်လည်ရန်"
     - Urgency coloring: number text color changes based on srsDue count
     - 0-2: text-emerald-600 dark:text-emerald-400
     - 3-5: text-amber-600 dark:text-amber-400
     - 6+: text-red-600 dark:text-red-400
   - **Practiced**: icon CheckCircle, value `practiced/totalQuestions`, navigate `/study`, label "Practiced" / "လေ့ကျင့်ပြီး"

4. CountUp configuration:
   - `duration={1.5}` for smooth animation
   - `useEasing={true}` for natural feel
   - When `shouldReduceMotion`, render static `<span>` instead of CountUp
   - For practiced stat: render as `<CountUp end={practiced} />/totalQuestions` (only the practiced number animates)
   - **Do NOT re-animate on every render**: Use a `key` based on data values to only animate when data actually changes. Alternatively, use CountUp `preserveValue` prop.
   - When value is 0 and isLoading is false, show "0" static (no animation from 0 to 0)

5. Loading state: When `isLoading`, show skeleton placeholders (4 glass cards with pulsing gray bars instead of values)

6. Each card is wrapped with GlassCard `interactive` prop for hover effects. Inner content is a `<button>` with min-h-[44px] for touch target. Use `useNavigate()` for programmatic navigation on click.

7. Show bilingual labels using `useLanguage()` showBurmese flag, matching the StatCard pattern from OverviewTab.

**Patterns to follow:**
- StatCard from `src/components/hub/StatCard.tsx` for layout structure
- CountUpScore from `src/components/celebrations/CountUpScore.tsx` for count-up approach
- useReducedMotion hook for accessibility
  </action>
  <verify>`npx tsc --noEmit` passes; component file exists at expected path</verify>
  <done>CompactStatRow renders 4 glass stat cards with count-up animation, urgency coloring on SRS, bilingual labels, tappable navigation, loading skeleton, and reduced-motion support</done>
</task>

<task type="auto">
  <name>Task 2: Create CategoryPreviewCard and RecentActivityCard</name>
  <files>src/components/dashboard/CategoryPreviewCard.tsx, src/components/dashboard/RecentActivityCard.tsx</files>
  <action>
**CategoryPreviewCard** (`src/components/dashboard/CategoryPreviewCard.tsx`):

Props:
```typescript
interface CategoryPreviewCardProps {
  categoryMasteries: Record<string, number>;
  isLoading: boolean;
}
```

Implementation:
1. GlassCard wrapper with rounded-2xl, slightly taller than stat cards (p-5)
2. Header: small icon (BarChart3 or PieChart from lucide) + "Category Progress" title, bilingual
3. Body: list the top 3 WEAKEST categories (sorted by mastery ascending)
   - Each shows: category name (English only to save space), small progress bar, mastery % number
   - Progress bar uses getMasteryColor from CategoryDonut for color interpolation (red->amber->green)
   - If fewer than 3 categories have data, show however many exist
4. Footer: "View all in Hub" text link
5. Whole card is tappable -- navigate to `/hub/overview` on click
6. Loading state: skeleton bars
7. If no mastery data yet (all zeros), show a brief "Start studying to see progress" message

**RecentActivityCard** (`src/components/dashboard/RecentActivityCard.tsx`):

Props:
```typescript
interface RecentActivityCardProps {
  testHistory: { date: string; score: number; totalQuestions: number }[];
  isLoading: boolean;
}
```

Implementation:
1. GlassCard wrapper with rounded-2xl, p-5 (matching CategoryPreviewCard)
2. Header: Clock icon + "Recent Activity" title, bilingual ("မကြာသေးမီက လှုပ်ရှားမှု")
3. Body: last 2-3 mock test sessions from testHistory (already sorted newest first)
   - Each shows: relative date (Today, Yesterday, X days ago, or "MMM D" format), score as "X/Y", and pass/fail indicator
   - Pass threshold: score/totalQuestions >= 0.6 (12/20)
   - Use formatRelativeDate helper (inline or from existing HistoryTab if exported)
4. Footer: "View full history" text link
5. Whole card is tappable -- navigate to `/hub/history` on click
6. Loading state: skeleton lines
7. Empty state: "Take a mock test to see your history" message

**Both cards share:**
- GlassCard interactive wrapper for hover effects
- `cursor-pointer` on the card
- onClick navigates to relevant Hub tab
- Bilingual headings using showBurmese
- Slightly different visual weight than stat cards (taller, wider content area)
- Responsive: side-by-side on md+ (`md:grid-cols-2`), stacked on mobile -- the parent grid handles this, not the cards themselves
  </action>
  <verify>`npx tsc --noEmit` passes; both component files exist</verify>
  <done>CategoryPreviewCard shows top 3 weak categories with mastery bars; RecentActivityCard shows last 2-3 test sessions with date and score; both tappable to Hub tabs, bilingual, with loading/empty states</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- All three component files exist: CompactStatRow.tsx, CategoryPreviewCard.tsx, RecentActivityCard.tsx
- Components use GlassCard wrapper consistently
- CountUp imported from react-countup (not a custom implementation)
- useReducedMotion checked for count-up animation
</verification>

<success_criteria>
- CompactStatRow has 4 stats with count-up, urgency coloring, bilingual labels, and navigation
- CategoryPreviewCard shows weakest 3 categories with mastery progress bars
- RecentActivityCard shows last 2-3 test sessions with relative dates
- All cards use GlassCard design system
- Loading and empty states handled for all components
- Reduced motion supported throughout
</success_criteria>

<output>
After completion, create `.planning/phases/16-dashboard-next-best-action/16-02-SUMMARY.md`
</output>
