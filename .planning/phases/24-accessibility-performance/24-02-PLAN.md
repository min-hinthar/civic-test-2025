---
phase: 24-accessibility-performance
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/quiz/FeedbackPanel.tsx
  - src/components/quiz/SegmentedProgressBar.tsx
  - src/components/BilingualToast.tsx
  - src/components/ui/LanguageToggle.tsx
autonomous: true

must_haves:
  truths:
    - "Screen reader announces 'Correct. [explanation]' or 'Incorrect. The answer is [X]. [explanation]' after Check in practice mode"
    - "Each progress bar segment is individually labeled for screen readers ('Question 3: Correct', 'Question 7: Skipped')"
    - "Language toggle announces full context ('Language: English only. Press to switch to bilingual English and Burmese.')"
    - "Error toasts use role=alert with aria-live=assertive; success/info toasts use role=status with aria-live=polite"
  artifacts:
    - path: "src/components/quiz/FeedbackPanel.tsx"
      provides: "Screen reader verdict announcement via aria-live assertive region"
      contains: "aria-live"
    - path: "src/components/quiz/SegmentedProgressBar.tsx"
      provides: "Per-segment accessible labels"
      contains: "aria-label"
    - path: "src/components/BilingualToast.tsx"
      provides: "Split toast roles (alert vs status)"
      contains: "role=\"status\""
  key_links:
    - from: "src/components/quiz/FeedbackPanel.tsx"
      to: "screen reader"
      via: "aria-live='assertive' sr-only region"
      pattern: "aria-live.*assertive"
---

<objective>
Add screen reader announcements to the quiz flow, fix progress bar segment accessibility, update language toggle labels, and split toast roles by severity.

Purpose: Screen reader users get meaningful feedback during quiz/practice sessions (A11Y-01). All toasts are properly announced. Language toggle provides full context.
Output: Updated FeedbackPanel, SegmentedProgressBar, BilingualToast, and LanguageToggle with proper ARIA support.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@src/components/quiz/FeedbackPanel.tsx
@src/components/quiz/SegmentedProgressBar.tsx
@src/components/BilingualToast.tsx
@src/components/ui/LanguageToggle.tsx
@.planning/phases/24-accessibility-performance/24-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: FeedbackPanel screen reader announcements + Toast role splitting</name>
  <files>src/components/quiz/FeedbackPanel.tsx, src/components/BilingualToast.tsx</files>
  <action>
    **FeedbackPanel (A11Y-01 locked decision):**

    1. Add a dedicated sr-only `aria-live="assertive"` div that is ALWAYS in the DOM (not conditionally rendered). This ensures the screen reader detects the content change.

    2. When `show` becomes true, populate the sr-only text with:
       - Correct (practice): `"Correct. {explanation?.brief_en ?? ''}"`
       - Incorrect (practice): `"Incorrect. The answer is {correctAnswer}. {explanation?.brief_en ?? ''}"`
       - Mock test (Claude's discretion): simpler verdict -- just `"Correct."` or `"Incorrect. The answer is {correctAnswer}."` (no explanation, simulation fidelity)

    3. Pattern:
       ```tsx
       <div aria-live="assertive" className="sr-only">
         {show && announcementText}
       </div>
       ```
       Place this OUTSIDE the animated panel div so it is not affected by animation delays.

    4. The existing `role="status" aria-live="polite"` on the panel body can remain for general status, but the assertive sr-only is the primary announcement channel.

    **BilingualToast (locked decision: all toasts accessible):**

    1. The ToastContainer currently uses `aria-live="assertive"` for ALL toasts. Split this:
       - Error/warning toasts: keep `role="alert"` (implies `aria-live="assertive"`)
       - Success/info toasts: change to `role="status"` (implies `aria-live="polite"`)

    2. In the Toast component, conditionally set role:
       ```tsx
       role={toast.type === 'error' || toast.type === 'warning' ? 'alert' : 'status'}
       ```

    3. The ToastContainer wrapper should use `aria-live="polite"` (the individual toast roles handle urgency).

    4. Remove `aria-atomic="true"` from the container -- each toast is a separate announcement, not an atomic region.
  </action>
  <verify>
    - `pnpm run typecheck` passes
    - `pnpm run lint` passes
    - Grep for `aria-live="assertive"` in FeedbackPanel confirms sr-only region exists
    - Grep for `role="status"` in BilingualToast confirms split roles
  </verify>
  <done>FeedbackPanel announces verdict to screen readers via assertive live region. Toasts use appropriate roles (alert for error/warning, status for success/info).</done>
</task>

<task type="auto">
  <name>Task 2: SegmentedProgressBar segment labels + Language toggle full context</name>
  <files>src/components/quiz/SegmentedProgressBar.tsx, src/components/ui/LanguageToggle.tsx</files>
  <action>
    **SegmentedProgressBar (locked decision: per-segment labels):**

    1. The research notes that segments currently have `aria-label` on individual segments but use `role="presentation"` which HIDES them from the a11y tree.

    2. Fix: Change the progress bar container to use `role="list"` and each segment to use `role="listitem"`. Remove any `role="presentation"` on segments.

    3. Each segment's aria-label should follow the locked format:
       - `"Question {N}: Correct"` / `"Question {N}: Incorrect"` / `"Question {N}: Skipped"` / `"Question {N}: Current"` / `"Question {N}: Unanswered"`

    4. Verify the status labels match the 5 segment states in the component: correct, incorrect, skipped, current, unanswered.

    5. Add an overall accessible name to the container: `aria-label="Quiz progress"`.

    **LanguageToggle (locked decision: full context labels):**

    1. Find the LanguageToggle or FlagToggle component (may be in `src/components/ui/` or `src/components/bilingual/`).

    2. Update the aria-label to the locked decision format:
       ```
       showBurmese
         ? 'Language: Bilingual English and Burmese. Press to switch to English only.'
         : 'Language: English only. Press to switch to bilingual English and Burmese.'
       ```

    3. If there are multiple toggle components (sidebar FlagToggle, settings page), update ALL instances consistently.

    4. Also add `aria-live="polite"` on a sr-only span near the toggle that announces the new state after toggle: `"Switched to English only"` or `"Switched to bilingual English and Burmese"`.
  </action>
  <verify>
    - `pnpm run typecheck` passes
    - `pnpm run lint` passes
    - Grep for `role="listitem"` in SegmentedProgressBar
    - Grep for `Language: English only` in LanguageToggle/FlagToggle
  </verify>
  <done>Progress bar segments are individually labeled for screen readers. Language toggle provides full context in aria-label.</done>
</task>

</tasks>

<verification>
- `pnpm run typecheck` passes
- `pnpm run lint` passes
- `pnpm test:run` passes (no regressions)
- FeedbackPanel has sr-only assertive live region
- SegmentedProgressBar segments have individual labels accessible to screen readers
- BilingualToast uses split roles (alert vs status)
- LanguageToggle has full context aria-label
</verification>

<success_criteria>
- Screen reader can hear verdict + explanation after Check in practice mode
- Each progress bar segment individually labeled ("Question 3: Correct")
- Language toggle announces full state context
- Error toasts are assertive, success/info toasts are polite
</success_criteria>

<output>
After completion, create `.planning/phases/24-accessibility-performance/24-02-SUMMARY.md`
</output>
