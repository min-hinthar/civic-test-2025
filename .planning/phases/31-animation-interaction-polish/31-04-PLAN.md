---
phase: 31-animation-interaction-polish
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/Card.tsx
  - src/components/ui/GlassCard.tsx
autonomous: true
requirements: [ANIM-04]

must_haves:
  truths:
    - "Card components enter with scale(0.95 to 1) + fade animation on mount"
    - "GlassCard components enter with scale(0.95 to 1) + fade animation on mount"
    - "Enter animation can be disabled via an animate={false} prop"
    - "prefers-reduced-motion skips the enter animation entirely"
    - "Card enter animation uses spring physics for natural deceleration"
    - "Cards nested inside StaggeredList get animation from the stagger parent, not double-animation"
  artifacts:
    - path: "src/components/ui/Card.tsx"
      provides: "Card with scale+fade enter animation on mount"
      contains: "motion"
    - path: "src/components/ui/GlassCard.tsx"
      provides: "GlassCard with scale+fade enter animation on mount"
      contains: "motion"
  key_links:
    - from: "src/components/ui/Card.tsx"
      to: "src/lib/motion-config.ts"
      via: "import SPRING_GENTLE for enter animation"
      pattern: "import.*SPRING_GENTLE.*motion-config"
    - from: "src/components/ui/GlassCard.tsx"
      to: "motion/react"
      via: "motion.div wrapper for enter animation"
      pattern: "motion\\.div"
---

<objective>
Add consistent scale(0.95 to 1) + fade enter animations to Card.tsx and GlassCard.tsx so all card components across the app enter with a subtle, satisfying pop-in.

Purpose: Cards currently appear instantly on mount, missing an opportunity for visual polish. A subtle scale+fade entrance makes content feel like it's materializing naturally, adds spatial depth, and creates a consistent feel across all screens. This is one of the most impactful single changes for perceived polish.

Output: Updated Card.tsx and GlassCard.tsx with enter animations that respect reduced motion and can be disabled when cards are used inside stagger containers.
</objective>

<execution_context>
@C:/Users/minkk/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/minkk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/ui/Card.tsx
@src/components/ui/GlassCard.tsx
@src/lib/motion-config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add enter animation to Card.tsx</name>
  <files>src/components/ui/Card.tsx</files>
  <action>
Add a scale(0.95 to 1) + opacity(0 to 1) enter animation to Card on mount.

**Implementation:**

1. **Add `animate` prop** (default: `true`) to `CardProps`:
   ```typescript
   export interface CardProps extends HTMLAttributes<HTMLDivElement> {
     elevated?: boolean;
     interactive?: boolean;
     /** Enable enter animation (scale+fade). Default: true. Set false inside StaggeredList. */
     animate?: boolean;
     children: ReactNode;
   }
   ```

2. **For non-interactive cards** (currently a plain `<div>`): Wrap in `motion.div` when `animate` is true:
   ```typescript
   if (!interactive) {
     if (animate && !shouldReduceMotion) {
       return (
         <motion.div
           ref={ref}
           initial={{ opacity: 0, scale: 0.95 }}
           animate={{ opacity: 1, scale: 1 }}
           transition={SPRING_GENTLE}
           className={baseClasses}
           {...(props as Omit<HTMLMotionProps<'div'>, 'ref'>)}
         >
           {children}
         </motion.div>
       );
     }
     return (
       <div ref={ref} className={baseClasses} {...props}>
         {children}
       </div>
     );
   }
   ```

3. **For interactive cards** (already a `motion.div`): Add `initial` and `animate` props when `animate` is true:
   ```typescript
   // Interactive card already uses motion.div for hover
   // Add enter animation by setting initial/animate
   return (
     <motion.div
       ref={ref}
       variants={motionVariants}
       initial={animate && !shouldReduceMotion ? { scale: 0.95, opacity: 0, ...motionVariants.idle } : 'idle'}
       animate={animate && !shouldReduceMotion ? { scale: 1, opacity: 1, ...motionVariants.idle } : 'visible'}
       // ... rest same as current
     />
   );
   ```

   Actually, mixing `variants` with explicit `initial`/`animate` objects can be tricky. Better approach for interactive cards: use the `variants` system and add the enter state to the `idle` variant via a two-phase approach:

   ```typescript
   // If animate, start from hidden state and transition to idle
   initial={animate && !shouldReduceMotion ? { opacity: 0, scale: 0.95, y: 0 } : 'idle'}
   animate="idle"
   ```

   This works because `animate="idle"` will transition from the initial values to the idle variant values (which include `y: 0` and the idle boxShadow).

4. **When `animate` is false** (card is inside a StaggeredList that handles its own animation), render without initial/animate props:
   - Non-interactive: plain `<div>` (no motion.div needed)
   - Interactive: `motion.div` but with `initial="idle"` (no enter animation, just hover/tap)

5. **Prevent double-animation in StaggeredList.** The CONTEXT says "Cards in lists get BOTH stagger timing AND the card scale(0.95->1)+fade animation." This means when a Card is inside a StaggeredList, the STAGGER handles the timing (delay), and the card handles the actual scale+fade. The StaggeredItem already provides `opacity: 0 -> 1` and `y: 20 -> 0` animation. If Card ALSO does `opacity: 0 -> 1` and `scale: 0.95 -> 1`, the opacity animations would fight each other.

   Resolution: When inside StaggeredList, set `animate={false}` on Card. The StaggeredItem wraps the Card and handles both the stagger timing and the visual transition. The StaggeredItem variants already include scale (0.9 -> 1) and opacity (0 -> 1). So the Card's own enter animation should be disabled inside lists. Document this in the Card component JSDoc.

6. **IMPORTANT CSS consideration:** The `motion.div` wrapper for non-interactive cards adds a DOM element. Ensure it doesn't break layout by passing through the `className` to the `motion.div` directly (which is already how it works).

7. **Avoid backdrop-filter + transform conflict:** Card.tsx doesn't use backdrop-filter, so this pitfall doesn't apply. But GlassCard does — handle that in Task 2.
  </action>
  <verify>
- `npm run typecheck` passes
- `npm run lint` passes
- Card component renders with enter animation (visual check)
- Card with `animate={false}` renders without enter animation
- Interactive cards still have hover/tap behavior
  </verify>
  <done>
Card.tsx enters with scale(0.95->1) + fade animation using SPRING_GENTLE. Animation disabled via `animate={false}` prop for use inside StaggeredList. Interactive cards combine enter animation with existing hover/tap variants. Reduced motion users see instant render.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add enter animation to GlassCard.tsx</name>
  <files>src/components/ui/GlassCard.tsx</files>
  <action>
Add the same scale(0.95 to 1) + fade enter animation to GlassCard.

**Implementation:**

1. **Import motion and spring config:**
   ```typescript
   import { motion, type HTMLMotionProps } from 'motion/react';
   import { useReducedMotion } from '@/hooks/useReducedMotion';
   import { SPRING_GENTLE } from '@/lib/motion-config';
   ```

2. **Add `animate` prop** (default: `true`) to GlassCardProps.

3. **CRITICAL: backdrop-filter + transform conflict.** GlassCard uses `backdrop-filter` via glass CSS classes. Applying `transform` (from motion/react) on the SAME element can cause rendering artifacts on WebKit browsers where the blur disappears during animation.

   **Solution:** Use a two-element approach:
   - Outer `motion.div` handles the animation (scale, opacity)
   - Inner `div` has the glass classes (backdrop-filter)

   ```typescript
   export function GlassCard({
     children,
     tier = 'light',
     interactive = false,
     animate: enableAnimation = true,
     className,
     ...rest
   }: GlassCardProps) {
     const shouldReduceMotion = useReducedMotion();
     const shouldAnimate = enableAnimation && !shouldReduceMotion;

     const glassDiv = (
       <div
         className={clsx(
           TIER_CLASSES[tier],
           'p-5',
           interactive && 'glass-card-interactive cursor-pointer',
           className
         )}
         {...rest}
       >
         {children}
       </div>
     );

     if (!shouldAnimate) return glassDiv;

     return (
       <motion.div
         initial={{ opacity: 0, scale: 0.95 }}
         animate={{ opacity: 1, scale: 1 }}
         transition={SPRING_GENTLE}
       >
         {glassDiv}
       </motion.div>
     );
   }
   ```

   **IMPORTANT:** The `motion.div` wrapper must NOT have any layout-affecting classes (padding, border, etc.) — it's purely an animation container. All styling stays on the inner glass div.

4. **When `animate={false}`**, render the glass div directly without the motion wrapper (no extra DOM node).

5. **Props forwarding:** The `...rest` props (onClick, role, etc.) go on the inner glass div since that's the semantically meaningful element. The outer motion.div is transparent to the consumer.

6. **Mark 'use client'** at top since this now imports hooks and motion.
  </action>
  <verify>
- `npm run typecheck` passes
- `npm run lint` passes
- GlassCard renders with enter animation (visual check)
- GlassCard with `animate={false}` renders without wrapper div
- backdrop-filter blur is visible during and after animation (no WebKit artifact)
  </verify>
  <done>
GlassCard.tsx enters with scale(0.95->1) + fade via an outer motion.div wrapper that avoids backdrop-filter + transform conflicts. Animation disabled via `animate={false}`. Reduced motion users see instant render. Glass blur remains visible throughout the animation.
  </done>
</task>

</tasks>

<verification>
- `npm run typecheck` passes with no errors
- `npm run lint` passes
- `npm run build` completes without errors
- Card and GlassCard both import from motion/react
- Both components accept `animate` prop defaulting to true
- Enter animation uses SPRING_GENTLE from motion-config.ts
- GlassCard uses wrapper div to avoid transform + backdrop-filter conflict
</verification>

<success_criteria>
All cards across the app (Card and GlassCard) enter with a satisfying scale(0.95->1) + fade animation that uses spring physics for natural deceleration. The animation can be disabled when cards are used inside stagger containers. Glass blur is preserved during animation. Reduced motion users see instant content.
</success_criteria>

<output>
After completion, create `.planning/phases/31-animation-interaction-polish/31-04-SUMMARY.md`
</output>
